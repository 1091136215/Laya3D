var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**This class is automatically generated by LayaAirIDE, please do not make any modifications. */


var _GameUI = require("./script/GameUI");

var _GameUI2 = _interopRequireDefault(_GameUI);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var GameConfig = function () {
    function GameConfig() {
        _classCallCheck(this, GameConfig);
    }

    _createClass(GameConfig, null, [{
        key: "init",
        value: function init() {
            //注册Script或者Runtime引用
            var reg = Laya.ClassUtils.regClass;
            reg("script/GameUI.js", _GameUI2.default);
        }
    }]);

    return GameConfig;
}();

exports.default = GameConfig;

GameConfig.width = 640;
GameConfig.height = 1136;
GameConfig.scaleMode = "fixedwidth";
GameConfig.screenMode = "none";
GameConfig.alignV = "top";
GameConfig.alignH = "left";
GameConfig.startScene = "test/TestScene.scene";
GameConfig.sceneRoot = "";
GameConfig.debug = false;
GameConfig.stat = false;
GameConfig.physicsDebug = false;
GameConfig.exportSceneToJson = true;

GameConfig.init();

},{"./script/GameUI":10}],2:[function(require,module,exports){
"use strict";

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _GameConfig = require("./GameConfig");

var _GameConfig2 = _interopRequireDefault(_GameConfig);

var _layaMaxUI = require("./ui/layaMaxUI");

var _layaMaxUI2 = _interopRequireDefault(_layaMaxUI);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Main = function () {
	function Main() {
		_classCallCheck(this, Main);

		//根据IDE设置初始化引擎		
		if (window["Laya3D"]) Laya3D.init(_GameConfig2.default.width, _GameConfig2.default.height);else Laya.init(_GameConfig2.default.width, _GameConfig2.default.height, Laya["WebGL"]);
		Laya["Physics"] && Laya["Physics"].enable();
		Laya["DebugPanel"] && Laya["DebugPanel"].enable();
		Laya.stage.scaleMode = _GameConfig2.default.scaleMode;
		Laya.stage.screenMode = _GameConfig2.default.screenMode;
		Laya.stage.alignV = _GameConfig2.default.alignV;
		Laya.stage.alignH = _GameConfig2.default.alignH;
		//兼容微信不支持加载scene后缀场景
		Laya.URL.exportSceneToJson = _GameConfig2.default.exportSceneToJson;

		//打开调试面板（通过IDE设置调试模式，或者url地址增加debug=true参数，均可打开调试面板）
		if (_GameConfig2.default.debug || Laya.Utils.getQueryString("debug") == "true") Laya.enableDebugPanel();
		if (_GameConfig2.default.physicsDebug && Laya["PhysicsDebugDraw"]) Laya["PhysicsDebugDraw"].enable();
		if (_GameConfig2.default.stat) Laya.Stat.show();
		Laya.alertGlobalError = true;

		//激活资源版本控制，version.json由IDE发布功能自动生成，如果没有也不影响后续流程
		Laya.ResourceVersion.enable("version.json", Laya.Handler.create(this, this.onVersionLoaded), Laya.ResourceVersion.FILENAME_VERSION);
	}

	_createClass(Main, [{
		key: "onVersionLoaded",
		value: function onVersionLoaded() {
			//激活大小图映射，加载小图的时候，如果发现小图在大图合集里面，则优先加载大图合集，而不是小图
			Laya.AtlasInfoManager.enable("fileconfig.json", Laya.Handler.create(this, this.onConfigLoaded));
		}
	}, {
		key: "onConfigLoaded",
		value: function onConfigLoaded() {
			//加载IDE指定的场景
			_GameConfig2.default.startScene && Laya.Scene.open(_GameConfig2.default.startScene);
		}
	}]);

	return Main;
}();
//激活启动类


new Main();

},{"./GameConfig":1,"./ui/layaMaxUI":13}],3:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _GameMainScene = require("./GameMainScene");

var _GameMainScene2 = _interopRequireDefault(_GameMainScene);

var _Observer = require("./Observer");

var _Observer2 = _interopRequireDefault(_Observer);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var CameraManager = function (_Laya$Script3D) {
    _inherits(CameraManager, _Laya$Script3D);

    function CameraManager() {
        _classCallCheck(this, CameraManager);

        var _this = _possibleConstructorReturn(this, (CameraManager.__proto__ || Object.getPrototypeOf(CameraManager)).call(this));

        _this._tempVector3 = new Laya.Vector3();
        _this.yawPitchRoll = new Laya.Vector3();
        _this.resultRotation = new Laya.Quaternion();
        _this.tempRotationZ = new Laya.Quaternion();
        _this.tempRotationX = new Laya.Quaternion();
        _this.tempRotationY = new Laya.Quaternion();
        _this.rotaionSpeed = 0.00006;
        _this.cameraDebug = true;
        //0.34,4.87,-0.62 pos
        //0.062,0.718,0.693,-0.015 rot
        //this.startPos = new Laya.Vector3(0.34,4.87,-0.62);
        //this.startRotation = new Laya.Vector4(0.062,0.718,0.693,-0.015);
        //观察者
        _this.mainSceneObser = 0;
        return _this;
    }

    _createClass(CameraManager, [{
        key: "onAwake",
        value: function onAwake() {
            this.camera = this.owner;
            this.mainSceneObser = this.camera.parent.getComponent(_GameMainScene2.default).mainObserver;
            if (this.cameraDebug) {
                Laya.stage.on(Laya.Event.RIGHT_MOUSE_DOWN, this, this.mouseDown);
                Laya.stage.on(Laya.Event.RIGHT_MOUSE_UP, this, this.mouseUp);
            }
            //this.setPosAndRotation(true, this.startPos, this.startRotation);
            this.mainSceneObser.watch("cameraMove", this.setPosAndRotation.bind(this));
        }
    }, {
        key: "_onDestroy",
        value: function _onDestroy() {
            //关闭监听函数
            Laya.stage.off(Laya.Event.RIGHT_MOUSE_DOWN, this, this.mouseDown);
            Laya.stage.off(Laya.Event.RIGHT_MOUSE_UP, this, this.mouseUp);
        }
    }, {
        key: "onUpdate",
        value: function onUpdate(state) {

            if (!this.cameraDebug) return;
            Laya.KeyBoardManager.hasKeyDown(37) && this.showPosAndRotation(null, 0.01, null);
            Laya.KeyBoardManager.hasKeyDown(39) && this.showPosAndRotation(null, -0.01, null);
            Laya.KeyBoardManager.hasKeyDown(38) && this.updateRotate(null, null, 0.01); //E
            Laya.KeyBoardManager.hasKeyDown(40) && this.updateRotate(null, null, -0.01); //E
            var elapsedTime = Laya.timer.delta;
            // if (!isNaN(this.lastMouseX) && !isNaN(this.lastMouseY) && this.isMouseDown) {
            //     var scene = this.owner.scene;
            //     Laya.KeyBoardManager.hasKeyDown(87) && this.moveForward(-0.01 * elapsedTime);//W
            //     Laya.KeyBoardManager.hasKeyDown(83) && this.moveForward(0.01 * elapsedTime);//S
            //     Laya.KeyBoardManager.hasKeyDown(65) && this.moveRight(-0.01 * elapsedTime);//A
            //     Laya.KeyBoardManager.hasKeyDown(68) && this.moveRight(0.01 * elapsedTime);//D
            //     Laya.KeyBoardManager.hasKeyDown(81) && this.moveVertical(0.01 * elapsedTime);//Q
            //     Laya.KeyBoardManager.hasKeyDown(69) && this.moveVertical(-0.01 * elapsedTime);//E

            //     var offsetX = Laya.stage.mouseX - this.lastMouseX;
            //     var offsetY = Laya.stage.mouseY - this.lastMouseY;

            //     var yprElem = this.yawPitchRoll;
            //     yprElem.x -= offsetX * this.rotaionSpeed * elapsedTime;
            //     yprElem.y -= offsetY * this.rotaionSpeed * elapsedTime;
            //     //this.updateRotation();
            //    // this.updateRotate(offsetX * this.rotaionSpeed * elapsedTime,offsetY * this.rotaionSpeed * elapsedTime)
            // }
            // this.lastMouseX = Laya.stage.mouseX;
            // this.lastMouseY = Laya.stage.mouseY;

        }
    }, {
        key: "mouseDown",
        value: function mouseDown(e) {
            this.showPosAndRotation();
            // if (!this.cameraDebug) return;
            // //获得鼠标的旋转值
            // this.camera.transform.localRotation.getYawPitchRoll(this.yawPitchRoll);
            // //获得鼠标的xy值
            // this.lastMouseX = Laya.stage.mouseX;
            // this.lastMouseY = Laya.stage.mouseY;
            // //设置bool值
            // this.isMouseDown = true;
        }
    }, {
        key: "mouseUp",
        value: function mouseUp(e) {
            if (!this.cameraDebug) return;
            //设置bool值
            this.isMouseDown = false;
        }
        /**
         * 向前移动。
         */

    }, {
        key: "moveForward",
        value: function moveForward(distance) {
            this._tempVector3.x = 0;
            this._tempVector3.y = 0;
            this._tempVector3.z = distance;
            this.camera.transform.translate(this._tempVector3);
        }
        /**
         * 向右移动。
         */

    }, {
        key: "moveRight",
        value: function moveRight(distance) {
            this._tempVector3.y = 0;
            this._tempVector3.z = 0;
            this._tempVector3.x = distance;
            this.camera.transform.translate(this._tempVector3);
        }
        /**
         * 向上移动。
         */

    }, {
        key: "moveVertical",
        value: function moveVertical(distance) {
            this._tempVector3.x = this._tempVector3.z = 0;
            this._tempVector3.y = distance;
            this.camera.transform.translate(this._tempVector3, false);
        }
    }, {
        key: "updateRotation",
        value: function updateRotation() {
            // if (Math.abs(this.yawPitchRoll.y) < 1.50) {
            Laya.Quaternion.createFromYawPitchRoll(this.yawPitchRoll.x, this.yawPitchRoll.y, this.yawPitchRoll.z, this.tempRotationZ);
            this.tempRotationZ.cloneTo(this.camera.transform.localRotation);
            this.camera.transform.localRotation = this.camera.transform.localRotation;
            // }
        }
    }, {
        key: "showPosAndRotation",
        value: function showPosAndRotation() {
            console.log("information:Position");
            console.log(this.camera.transform.position);
            console.log("information:Rotation");
            console.log(this.camera.transform.rotation);
        }
    }, {
        key: "setPosAndRotation",
        value: function setPosAndRotation(isInit, pos, rotation) {
            if (pos) {
                var posInfo = {
                    curPos: this.camera.transform.position,
                    changePos: pos
                };
                if (isInit) {
                    this.camera.transform.position = posInfo.changePos;
                } else {
                    var finalPos = new Laya.Vector3(0, 0, 0);
                    Laya.Vector3.add(posInfo.curPos, posInfo.changePos, finalPos);
                    this.camera.transform.localPosition = finalPos;
                }
            }
            if (rotation) {
                var rotationInfo = {
                    curRotation: this.camera.transform.rotation,
                    changeRotation: rotation
                };
                if (isInit) {
                    this.camera.transform.rotation = rotationInfo.changeRotation;
                } else {
                    var finalRotation = new Laya.Vector4(0, 0, 0, 0);
                    Laya.Vector4.add(rotationInfo.changeRotation, rotationInfo.curRotation, finalRotation);
                    this.camera.transform.rotation = finalRotation;
                }
            }
        }
    }, {
        key: "updateRotate",
        value: function updateRotate(k, b, z) {
            if (k && b) {
                this.camera.transform.rotate(new Laya.Vector3(k, 0, b));
            }
            if (z) {
                this.camera.transform.rotate(new Laya.Vector3(0, z, 0));
            }
        }
    }]);

    return CameraManager;
}(Laya.Script3D);

exports.default = CameraManager;

},{"./GameMainScene":8,"./Observer":12}],4:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var CameraTransSet = function (_Laya$Script3D) {
    _inherits(CameraTransSet, _Laya$Script3D);

    function CameraTransSet() {
        _classCallCheck(this, CameraTransSet);

        return _possibleConstructorReturn(this, (CameraTransSet.__proto__ || Object.getPrototypeOf(CameraTransSet)).call(this));
        // this.startPos = new Laya.Vector3(0.34, 4.87, -0.62);
        // this.startPos = new Laya.Vector3(0, -5.15, -1.19);
        // this.startRotation = new Laya.Vector4(0.062, 0.718, 0.693, -0.015);
        // this.rotatev3=new Laya.Vector3(37.53,0,0)
    }

    _createClass(CameraTransSet, [{
        key: "onAwake",
        value: function onAwake() {
            this.camera = this.owner;
            this.setPosAndRotation(true, this.startPos, this.startRotation);
        }
    }, {
        key: "onEnable",
        value: function onEnable() {}
    }, {
        key: "onDisable",
        value: function onDisable() {}
    }, {
        key: "setPosAndRotation",
        value: function setPosAndRotation(isInit, pos, rotation, rotate) {
            if (pos) {
                var posInfo = {
                    curPos: this.camera.transform.position,
                    changePos: pos
                };
                if (isInit) {
                    this.camera.transform.position = posInfo.changePos;
                } else {
                    var finalPos = new Laya.Vector3(0, 0, 0);
                    Laya.Vector3.add(posInfo.curPos, posInfo.changePos, finalPos);
                    this.camera.transform.position = finalPos;
                }
            }
            if (rotation) {
                var rotationInfo = {
                    curRotation: this.camera.transform.rotation,
                    changeRotation: rotation
                };
                if (isInit) {
                    this.camera.transform.rotation = rotationInfo.changeRotation;
                } else {
                    var finalRotation = new Laya.Vector4(0, 0, 0, 0);
                    Laya.Vector4.add(rotationInfo.changeRotation, rotationInfo.curRotation, finalRotation);
                    this.camera.transform.rotation = finalRotation;
                }
            }
            if (rotate) {
                this.camera.transform.rotate(rotate);
            }
        }
    }]);

    return CameraTransSet;
}(Laya.Script3D);

exports.default = CameraTransSet;

},{}],5:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _GameMainScene = require("./GameMainScene");

var _GameMainScene2 = _interopRequireDefault(_GameMainScene);

var _GamePool = require("./GamePool");

var _GamePool2 = _interopRequireDefault(_GamePool);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var FloorBarManager = function (_Laya$Script3D) {
    _inherits(FloorBarManager, _Laya$Script3D);

    function FloorBarManager() {
        _classCallCheck(this, FloorBarManager);

        //设定速度
        var _this = _possibleConstructorReturn(this, (FloorBarManager.__proto__ || Object.getPrototypeOf(FloorBarManager)).call(this));

        _this.rotationData = 0;
        _this.rotateVec = Laya.Vector3.ZERO;
        _this.timeInterv = 0;
        _this.rotationSpeed = 0.7;
        _this.flag = false;
        //obser
        _this.mainSceneObser = 0;
        _this.isDispose = false;
        //pool
        _this.floorBarPool = 0;
        _this.floorRecycle = 2;
        _this.trans = { pos: 0, rot: 0 };

        return _this;
    }

    _createClass(FloorBarManager, [{
        key: "onAwake",
        value: function onAwake() {
            this.gameObj = this.owner;
        }
    }, {
        key: "onStart",
        value: function onStart() {
            this.mainSceneObser.watch("gameOver", this.disPose.bind(this));
            this.mainSceneObser.watch("recycle", this.recycleObj.bind(this));
            this.trans.pos = this.gameObj.transform.position;
            this.trans.rot = this.gameObj.transform.rotation;
        }
    }, {
        key: "onEnable",
        value: function onEnable() {
            this.timeInterv = 0;
        }
    }, {
        key: "onUpdate",
        value: function onUpdate() {
            return;
            if (this.isDispose) return;
            if (this.gameObj.name === _GameMainScene2.default.floorBarType.abnormal && this.rotationData !== 0) {
                this.timeInterv += this.rotationSpeed;
                this.rotateVec.setValue(0, 0, this.rotationSpeed * (this.flag ? 1 : -1));
                this.gameObj.transform.rotate(this.rotateVec, true, false);
                if (this.timeInterv > this.rotationData) {
                    this.timeInterv = 0;
                    this.flag = !this.flag;
                }
            }
        }
    }, {
        key: "onDisable",
        value: function onDisable() {
            this.gameObj.transform.position = this.trans.pos;
            this.gameObj.transform.rotation = this.trans.rot;
        }
    }, {
        key: "disPose",
        value: function disPose() {
            this.isDispose = true;
        }
    }, {
        key: "recycleObj",
        value: function recycleObj(curFloorIndex) {
            if (curFloorIndex - this.floorRecycle >= 0) {
                var index = this.gameObj.parent.parent.parent.getChildIndex(this.gameObj.parent.parent);
                if (index == curFloorIndex - this.floorRecycle) {
                    var obj = this.gameObj; //.parent.removeChild(this.gameObj);
                    this.floorBarPool.putItem(obj.name, obj);
                    // obj.parent && this.floorBarPool.putItem(GameMainScene.floorBarType.blank, obj.parent)
                }
            }
        }
    }]);

    return FloorBarManager;
}(Laya.Script3D);

exports.default = FloorBarManager;

},{"./GameMainScene":8,"./GamePool":9}],6:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _GameMainScene = require("./GameMainScene");

var _GameMainScene2 = _interopRequireDefault(_GameMainScene);

var _FloorBarManager = require("./FloorBarManager");

var _FloorBarManager2 = _interopRequireDefault(_FloorBarManager);

var _GamePool = require("./GamePool");

var _GamePool2 = _interopRequireDefault(_GamePool);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var FloorCreateManager = function (_Laya$Script3D) {
    _inherits(FloorCreateManager, _Laya$Script3D);

    function FloorCreateManager() {
        _classCallCheck(this, FloorCreateManager);

        //观察者
        var _this = _possibleConstructorReturn(this, (FloorCreateManager.__proto__ || Object.getPrototypeOf(FloorCreateManager)).call(this));

        _this.mainSceneObser = 0;
        //对象池
        _this.floorBarPool = new _GamePool2.default();
        _this.floorBarPrefab = 0;
        _this.blankFloorPrefab = 0;
        //一次性生产Floor层数
        _this.creatLayer = 4;
        //每层之间的间隔y值
        _this.FloorInterv = 8;
        _this.curFloorLayerIndex = 0; //
        return _this;
    }

    _createClass(FloorCreateManager, [{
        key: "onAwake",
        value: function onAwake() {
            this.gameObj = this.owner;
            this.mainSceneObser = this.gameObj.parent.getComponent(_GameMainScene2.default).mainObserver;
            this.mainSceneObser.watch("creatFloor", this.floorInit.bind(this));
        }
    }, {
        key: "onEnable",
        value: function onEnable() {}
    }, {
        key: "onStart",
        value: function onStart() {
            //隐藏预制体
            this.floorBarPrefab.active = false;
            this.blankFloorPrefab.active = false;
            this.floorInit(this.creatLayer);
        }
    }, {
        key: "onUpdate",
        value: function onUpdate() {}
        //初始化

    }, {
        key: "floorInit",
        value: function floorInit(num) {
            //当前层数
            var floorIndex = 0;
            while (floorIndex < num) {
                //一层的总Floor
                var singleFloor = new Laya.Sprite3D();
                var randomData = this.getRandomData();
                var baseBlock = this.createBaseBlock(randomData);
                var spBlock = this.creatSPBlock(randomData);
                singleFloor.addChild(baseBlock);
                singleFloor.addChild(spBlock);
                // 一层的blank
                var blankFloorClone = Laya.Sprite3D.instantiate(this.blankFloorPrefab, singleFloor, false);
                blankFloorClone.name = _GameMainScene2.default.floorBarType.blank;
                blankFloorClone.active = true;

                singleFloor.transform.translate(new Laya.Vector3(0, -this.curFloorLayerIndex * this.FloorInterv, 0), true);
                floorIndex++;
                this.curFloorLayerIndex++;
                this.gameObj.addChild(singleFloor);
            }
        }
        /**获取随机数据 */

    }, {
        key: "getRandomData",
        value: function getRandomData() {
            var jsonData = Laya.loader.getRes("res/KHXM.json");
            var jsonArr = Object.keys(jsonData).map(function (key) {
                return jsonData[key];
            });
            var randomIndex = Math.floor(Math.random() * jsonArr.length);
            return jsonArr[randomIndex];
        }
    }, {
        key: "createBaseBlock",
        value: function createBaseBlock(randomData) {
            var baseBlockObjs = new Laya.Sprite3D();
            if (!randomData.base_block instanceof Array) return;
            for (var j = 0; j < randomData.base_block.length; j++) {
                var obj = randomData.base_block[j];
                if (obj) {
                    var floorClone;
                    var floorClone = this.floorBarPool.getItem(_GameMainScene2.default.floorBarType.normal);
                    if (!floorClone) {
                        floorClone = Laya.Sprite3D.instantiate(this.floorBarPrefab, baseBlockObjs, false);
                    } else {
                        baseBlockObjs.addChild(floorClone);
                        floorClone.transform.position = this.floorBarPrefab.transform.position;
                        floorClone.transform.rotation = this.floorBarPrefab.transform.rotation;
                    }
                    if (!floorClone.getComponent(_FloorBarManager2.default)) {
                        floorClone.addComponent(_FloorBarManager2.default);
                        floorClone.getComponent(_FloorBarManager2.default).mainSceneObser = this.mainSceneObser;
                        floorClone.getComponent(_FloorBarManager2.default).floorBarPool = this.floorBarPool;
                        floorClone.name = _GameMainScene2.default.floorBarType.normal;
                        if (obj === 2) {
                            floorClone.name = _GameMainScene2.default.floorBarType.stillObstacle;
                            //floorClone材质设置
                            floorClone.meshRenderer.material.albedoColor = new Laya.Vector4(1, 0, 0, 1);
                        }
                    }
                    //位置调整
                    floorClone.transform.rotate(new Laya.Vector3(0, 0, j * 22.5), true, false);
                    //反转//todo
                    if (randomData.reversal) {
                        // floorClone.transform.rotate(new Laya.Vector3(0, 180, 0), true, false);
                        // floorClone.transform.translate(new Laya.Vector3(2, 0, 0));
                    }
                    floorClone.active = true;
                }
            }
            return baseBlockObjs;
        }
    }, {
        key: "creatSPBlock",
        value: function creatSPBlock(randomData) {
            var spBlockObjs = new Laya.Sprite3D();
            if (!randomData.sp_block_size instanceof Array) return;
            for (var j = 0; j < randomData.sp_block_size.length; j++) {
                var obj = randomData.sp_block_size[j];
                if (obj) {
                    var num = 0;
                    while (num < obj) {
                        var floorClone;
                        floorClone = this.floorBarPool.getItem(_GameMainScene2.default.floorBarType.abnormal);
                        if (!floorClone) {
                            floorClone = Laya.Sprite3D.instantiate(this.floorBarPrefab, spBlockObjs, false);
                        } else {
                            spBlockObjs.addChild(floorClone);
                            floorClone.transform.position = this.floorBarPrefab.transform.position;
                            floorClone.transform.rotation = this.floorBarPrefab.transform.rotation;
                        }
                        if (!floorClone.getComponent(_FloorBarManager2.default)) {
                            //速度
                            floorClone.addComponent(_FloorBarManager2.default).rotationData = randomData.sp_block_move_speed[j];
                            floorClone.getComponent(_FloorBarManager2.default).mainSceneObser = this.mainSceneObser;
                            floorClone.getComponent(_FloorBarManager2.default).floorBarPool = this.floorBarPool;
                            //添加标签
                            floorClone.name = _GameMainScene2.default.floorBarType.abnormal;
                            //floorClone材质设置
                            floorClone.meshRenderer.material.albedoColor = new Laya.Vector4(1, 0, 0, 1);
                            floorClone.transform.localScale = new Laya.Vector3(1.005, 1.005, 1.005);
                        }
                        //起始位置
                        floorClone.transform.rotate(new Laya.Vector3(0, 0, num * 22.5 + randomData.sp_block_start_pos[j] * 22.5), true, false);
                        //反转//todo
                        // if (randomData.reversal) {
                        //     floorClone.transform.rotate(new Laya.Vector3(0, 0, 180), true, false);
                        //     floorClone.transform.translate(new Laya.Vector3(2, 0, 0));
                        // }
                        floorClone.active = true;
                        num++;
                    }
                }
                return spBlockObjs;
            }
        }
    }]);

    return FloorCreateManager;
}(Laya.Script3D);

exports.default = FloorCreateManager;

},{"./FloorBarManager":5,"./GameMainScene":8,"./GamePool":9}],7:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _GameMainScene = require("./GameMainScene");

var _GameMainScene2 = _interopRequireDefault(_GameMainScene);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var FloorMoveManager = function (_Laya$Script3D) {
    _inherits(FloorMoveManager, _Laya$Script3D);

    function FloorMoveManager() {
        _classCallCheck(this, FloorMoveManager);

        var _this = _possibleConstructorReturn(this, (FloorMoveManager.__proto__ || Object.getPrototypeOf(FloorMoveManager)).call(this));

        _this.yawPitchRoll = new Laya.Vector3();
        _this.tempRotationZ = new Laya.Quaternion();
        _this.rotaionSpeed = 0.0005;
        //obser
        _this.mainSceneObser = 0;
        _this.isDispose = false;
        return _this;
    }

    _createClass(FloorMoveManager, [{
        key: "onAwake",
        value: function onAwake() {
            Laya.stage.on(Laya.Event.MOUSE_DOWN, this, this.mouseDown);
            Laya.stage.on(Laya.Event.MOUSE_UP, this, this.mouseUp);
            this.gameObj = this.owner;
            this.mainSceneObser = this.gameObj.parent.getComponent(_GameMainScene2.default).mainObserver;
            this.mainSceneObser.watch("gameOver", this.disPose.bind(this));
        }
    }, {
        key: "_onDestroy",
        value: function _onDestroy() {
            //关闭监听函数
            Laya.stage.off(Laya.Event.MOUSE_DOWN, this, this.mouseDown);
            Laya.stage.off(Laya.Event.MOUSE_UP, this, this.mouseUp);
        }
    }, {
        key: "onUpdate",
        value: function onUpdate(state) {
            if (this.isDispose) return;
            var elapsedTime = Laya.timer.delta;
            if (!isNaN(this.lastMouseX) && this.isMouseDown) {
                var offsetX = Laya.stage.mouseX - this.lastMouseX;
                var yprElem = this.yawPitchRoll;
                yprElem.x += offsetX * this.rotaionSpeed * elapsedTime;
                // this.updateRotation();
                this.updateRotate(offsetX * this.rotaionSpeed * elapsedTime);
            }
            this.lastMouseX = Laya.stage.mouseX;
        }
    }, {
        key: "mouseDown",
        value: function mouseDown(e) {
            //获得鼠标的旋转值
            this.gameObj.transform.localRotation.getYawPitchRoll(this.yawPitchRoll);
            //获得鼠标的x值
            this.lastMouseX = Laya.stage.mouseX;
            //设置bool值
            this.isMouseDown = true;
        }
    }, {
        key: "mouseUp",
        value: function mouseUp(e) {
            //设置bool值
            this.isMouseDown = false;
        }
    }, {
        key: "updateRotation",
        value: function updateRotation() {
            Laya.Quaternion.createFromYawPitchRoll(this.yawPitchRoll.x, this.yawPitchRoll.y, this.yawPitchRoll.z, this.tempRotationZ);
            this.tempRotationZ.cloneTo(this.gameObj.transform.localRotation);
            this.gameObj.transform.localRotation = this.gameObj.transform.localRotation;
        }
    }, {
        key: "updateRotate",
        value: function updateRotate(k) {
            this.gameObj.transform.rotate(new Laya.Vector3(0, k, 0));
        }
    }, {
        key: "disPose",
        value: function disPose() {
            Laya.stage.off(Laya.Event.MOUSE_DOWN, this, this.mouseDown);
            Laya.stage.off(Laya.Event.MOUSE_UP, this, this.mouseUp);
            this.isDispose = true;
        }
    }]);

    return FloorMoveManager;
}(Laya.Script3D);

exports.default = FloorMoveManager;

},{"./GameMainScene":8}],8:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _ManManager = require("./ManManager");

var _ManManager2 = _interopRequireDefault(_ManManager);

var _FloorMoveManager = require("./FloorMoveManager");

var _FloorMoveManager2 = _interopRequireDefault(_FloorMoveManager);

var _FloorCreateManager = require("./FloorCreateManager");

var _FloorCreateManager2 = _interopRequireDefault(_FloorCreateManager);

var _CameraManager = require("./CameraManager");

var _CameraManager2 = _interopRequireDefault(_CameraManager);

var _Observer = require("./Observer");

var _Observer2 = _interopRequireDefault(_Observer);

var _CameraTransSet = require("./CameraTransSet");

var _CameraTransSet2 = _interopRequireDefault(_CameraTransSet);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var GameMainScene = function (_Laya$Script3D) {
    _inherits(GameMainScene, _Laya$Script3D);

    function GameMainScene() {
        _classCallCheck(this, GameMainScene);

        // this.mainCamera = 0;
        // this.mainLight = 0;
        // this.man = 0;
        // this.floorBarPrefab = 0;
        // this.creatFloor = 0;
        var _this = _possibleConstructorReturn(this, (GameMainScene.__proto__ || Object.getPrototypeOf(GameMainScene)).call(this));

        _this.mainObserver = new _Observer2.default();
        return _this;
    }

    _createClass(GameMainScene, [{
        key: "onAwake",
        value: function onAwake() {
            this.scene = this.owner;
        }
    }, {
        key: "onStart",
        value: function onStart() {
            var mainCamera = this.scene.getChildByName("Main Camera");
            mainCamera.addComponent(_CameraManager2.default);
            mainCamera.addComponent(_CameraTransSet2.default);
            var mainLight = this.scene.getChildByName("Directional Light");
            //地板块预制体
            var floorBarPrefab = this.scene.getChildByName("FloorBar");
            //空地板预制体
            var blankFloorPrefab = this.scene.getChildByName("BlankFloor");
            //地板(复合)
            var creatFloor = this.scene.getChildByName("FloorCreat");
            creatFloor.addComponent(_FloorCreateManager2.default).floorBarPrefab = floorBarPrefab;
            creatFloor.getComponent(_FloorCreateManager2.default).blankFloorPrefab = blankFloorPrefab;
            // creatFloor.addComponent(FloorMoveManager);
            //获取小球
            var man = this.scene.getChildByName("Man");
            man.addComponent(_ManManager2.default).floorContainer = creatFloor;
            man.getComponent(_ManManager2.default).camera = mainCamera;
        }
    }]);

    return GameMainScene;
}(Laya.Script3D);

exports.default = GameMainScene;

GameMainScene.floorBarType = {
    normal: "NORMAL",
    abnormal: "ABNORMAL",
    blank: "BLANK",
    stillObstacle: "STILLOBSTACLE"
};

},{"./CameraManager":3,"./CameraTransSet":4,"./FloorCreateManager":6,"./FloorMoveManager":7,"./ManManager":11,"./Observer":12}],9:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var GamePool = function () {
    function GamePool() {
        _classCallCheck(this, GamePool);

        this._pool = {};
    }

    _createClass(GamePool, [{
        key: "getItem",
        value: function getItem(key) {
            var obj;
            if (this._pool[key]) {
                if (this._pool[key].length) {
                    obj = this._pool[key].pop();
                }
            }
            return obj;
        }
    }, {
        key: "putItem",
        value: function putItem(key, obj) {
            obj.active = false;
            if (this._pool[key]) {
                this._pool[key].push(obj);
            } else {
                this._pool[key] = [];
                this._pool[key].push(obj);
            }
        }
        // getPool(type) {

        // }
        // clearPool(type) {

        // }

    }]);

    return GamePool;
}();

exports.default = GamePool;

},{}],10:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _GameMainScene = require("./GameMainScene");

var _GameMainScene2 = _interopRequireDefault(_GameMainScene);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

/**
 * 本示例采用非脚本的方式实现，而使用继承页面基类，实现页面逻辑。在IDE里面设置场景的Runtime属性即可和场景进行关联
 * 相比脚本方式，继承式页面类，可以直接使用页面定义的属性（通过IDE内var属性定义），比如this.tipLbll，this.scoreLbl，具有代码提示效果
 * 建议：如果是页面级的逻辑，需要频繁访问页面内多个元素，使用继承式写法，如果是独立小模块，功能单一，建议用脚本方式实现，比如子弹脚本。
 */
var GameUI = function (_Laya$Scene) {
    _inherits(GameUI, _Laya$Scene);

    function GameUI() {
        _classCallCheck(this, GameUI);

        //加载场景文件
        var _this = _possibleConstructorReturn(this, (GameUI.__proto__ || Object.getPrototypeOf(GameUI)).call(this));

        _this.loadScene("test/TestScene.scene");
        var resource = [{ url: "LayaScene_SampleScene/Conventional/SampleScene.ls", type: Laya3D.HIERARCHY, priority: 1 }];
        //预加载unity场景
        Laya.loader.create(resource, Laya.Handler.create(_this, _this.onLoadFinish));
        //预加载json
        Laya.loader.load("res/KHXM.json", Laya.Handler.create(_this, _this.onLoaded), null, Laya.Loader.JSON, 0);
        return _this;
    }

    _createClass(GameUI, [{
        key: "onLoadFinish",
        value: function onLoadFinish() {
            var fightScene = Laya.Loader.getRes("LayaScene_SampleScene/Conventional/SampleScene.ls");
            Laya.stage.addChildAt(fightScene, 0);
            fightScene.addComponent(_GameMainScene2.default);
        }
    }]);

    return GameUI;
}(Laya.Scene);

exports.default = GameUI;

},{"./GameMainScene":8}],11:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _GameMainScene = require("./GameMainScene");

var _GameMainScene2 = _interopRequireDefault(_GameMainScene);

var _FloorCreateManager = require("./FloorCreateManager");

var _FloorCreateManager2 = _interopRequireDefault(_FloorCreateManager);

var _GamePool = require("./GamePool");

var _GamePool2 = _interopRequireDefault(_GamePool);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var ManManager = function (_Laya$Script3D) {
    _inherits(ManManager, _Laya$Script3D);

    function ManManager() {
        _classCallCheck(this, ManManager);

        //弹起速度
        var _this = _possibleConstructorReturn(this, (ManManager.__proto__ || Object.getPrototypeOf(ManManager)).call(this));

        _this.restiSpeed = new Laya.Vector3(0, 8, 0);
        _this.impusle = new Laya.Vector3(0, -2, 0);
        //
        _this.manRigby = 0;
        _this.equipment = {
            defence: 0,
            speeder: 0
            //场景容器
        };_this.floorContainer = 0;
        //观察者
        _this.mainSceneObser = 0;
        //相机
        _this.camera = 0;
        _this.cameraPos = { startY: 0 };
        _this.isCameraMove = false;
        _this.justNum = 0;
        _this.offestNum = 0.8;
        _this.rate = -0.05;

        //当前层数
        _this.curFloorLayer = 0;
        //玩家得分
        _this.playMark = 0;
        //单次得分值
        _this.markValuePer = 1;
        //玩家开始位置
        _this.manPos = { startY: 0 };
        //连续穿过的floor
        _this.constantFloorLayer = 0;
        _this.constantSetLayer = 2;

        return _this;
    }

    _createClass(ManManager, [{
        key: "onAwake",
        value: function onAwake() {
            this.gameObj = this.owner;
            this.mainSceneObser = this.gameObj.parent.getComponent(_GameMainScene2.default).mainObserver;
        }
    }, {
        key: "onStart",
        value: function onStart() {
            this.manRigby = this.gameObj.getComponent(Laya.Rigidbody3D);
            this.manRigby.mass = 1;
            this.manRigby.angularDamping = 50;
            this.manPos.startY = this.gameObj.transform.position.y;
            this.cameraPos.startY = this.camera.transform.position.y;
            this.setCameraNum(this.offestNum, this.rate);
        }
    }, {
        key: "onUpdate",
        value: function onUpdate() {
            //console.log(this.gameObj.transform.rotation);
            if (this.isCameraMove) {
                this.camera.transform.localPositionY = this.cameraPos.startY + (this.gameObj.transform.position.y - this.manPos.startY);
                this.camera.transform.localPositionY -= this.justNum;
            }
            //if (!this.floorContainer.getChildAt(this.curFloorLayer)) return;
            //下降时
            // if (this.gameObj.transform.position.y< this.floorContainer.getChildAt(this.curFloorLayer).transform.position.y) {
            //     this.toNextFloor();
            // }

        }
    }, {
        key: "onTriggerEnter",
        value: function onTriggerEnter(other) {
            switch (other.owner.name) {
                case _GameMainScene2.default.floorBarType.blank:
                    other.owner.active = false;
                    this.toNextFloor();
                    break;
                case _GameMainScene2.default.floorBarType.normal:
                    if (this.constantFloorLayer >= this.constantSetLayer) {
                        this.constantFloorLayer = -1;
                        this.constantEffect(this.floorContainer.getChildAt(this.curFloorLayer));
                    } else {
                        this.constantFloorLayer = 0;
                    }
                    this.jumpUp();
                    break;
                case _GameMainScene2.default.floorBarType.stillObstacle:
                case _GameMainScene2.default.floorBarType.abnormal:
                    if (this.constantFloorLayer >= this.constantSetLayer) {
                        this.constantFloorLayer = -1;
                        this.constantEffect(this.floorContainer.getChildAt(this.curFloorLayer));
                        this.jumpUp();
                    } else {
                        //this.constantFloorLayer = 0;
                        this.dispose();
                    }
                    break;
                default:
                    break;
            }
        }
    }, {
        key: "manForceSet",
        value: function manForceSet(force, phy) {
            this.manRigby.linearVelocity = force;
            this.manRigby.angularVelocity = Laya.Vector3.ZERO;
            // this.gameObj.transform.localRotation = this.starRotat;
            this.manRigby.applyImpulse(this.impusle);
            // this.interv += Laya.timer.delta * 0.001;
            // if (this.interv < this.riseTime / 2) {
            //     this.gameObj.transform.localPositionY += this.riseDis * Laya.timer.delta * 0.001 / this.riseTime
            // }
            // else if (this.interv < this.riseTime) this.gameObj.transform.localPositionY -= this.riseDis * Laya.timer.delta * 0.001 / this.riseTime
            // else {
            //     this.interv = 0;
            // }
        }
    }, {
        key: "constantEffect",
        value: function constantEffect(curFloor) {
            for (var index = 0; index < curFloor._children.length; index++) {
                for (var j = 0; j < curFloor.getChildAt(index)._children.length; j++) {
                    var element = curFloor.getChildAt(index).getChildAt(j);
                    if (element) {
                        element.transform.translate(new Laya.Vector3(1, 1, 1));
                        element.transform.rotate(new Laya.Vector3(30, 40, 50), false, false);
                    }
                }
            }
        }
    }, {
        key: "toNextFloor",
        value: function toNextFloor() {
            this.manRigby.angularVelocity = Laya.Vector3.ZERO;
            this.manPos.startY = this.gameObj.transform.position.y; //初始位置
            this.cameraPos.startY = this.camera.transform.position.y;
            this.isCameraMove = true;
            this.mainSceneObser.notice("recycle", this.curFloorLayer);
            this.mainSceneObser.notice("creatFloor", 1);
            this.playMark += this.markValuePer;
            Laya.stage.getChildAt(1).getChildAt(0).getChildAt(0).text = "分数:" + this.playMark;
            this.constantFloorLayer++;
            this.curFloorLayer++;
            this.setCameraNum();
        }
    }, {
        key: "debugTrans",
        value: function debugTrans(obj) {
            console.log(obj.transform.position);
            console.log(obj.transform.localPosition);
            console.log(obj.transform.rotation);
            console.log(obj.transform.localRotation);
            console.log("------------------");
        }
        //设置偏移值

    }, {
        key: "setCameraNum",
        value: function setCameraNum() {
            if (this.constantFloorLayer && this.constantFloorLayer % 4 == 0) {
                //todo设置offest偏移
            }
            this.justNum = this.offestNum + this.constantFloorLayer * this.rate;
        }
    }, {
        key: "dispose",
        value: function dispose() {
            this.manRigby.isKinematic = true;
            if (this.isCameraMove) this.isCameraMove = false;
            this.mainSceneObser.notice("gameOver");
            Laya.timer.once(2000, this, function () {
                var gameOver = Laya.stage.getChildAt(1).getChildAt(0).getChildAt(1);
                gameOver.visible = true;
            });
        }
    }, {
        key: "jumpUp",
        value: function jumpUp(name) {
            if (this.isCameraMove) this.isCameraMove = false;
            this.manForceSet(this.restiSpeed); //反弹
            this.setCameraNum();
        }
    }]);

    return ManManager;
}(Laya.Script3D);

exports.default = ManManager;

},{"./FloorCreateManager":6,"./GameMainScene":8,"./GamePool":9}],12:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Observer = function () {
    function Observer() {
        _classCallCheck(this, Observer);

        this._dictionary = {};
    }

    _createClass(Observer, [{
        key: "watch",
        value: function watch(key, func) {
            if (this._dictionary[key]) {
                if (this._dictionary[key] != func) {
                    this._dictionary[key].push(func);
                }
            } else {
                this._dictionary[key] = [];
                this._dictionary[key].push(func);
            }
        }
    }, {
        key: "notice",
        value: function notice(key) {
            for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
                args[_key - 1] = arguments[_key];
            }

            for (var obj in this._dictionary[key]) {
                if (this._dictionary[key].hasOwnProperty(obj)) {
                    var element = this._dictionary[key][obj];
                    element.apply(undefined, args);
                }
            }
        }
    }, {
        key: "removeAllObserver",
        value: function removeAllObserver() {
            this._dictionary = {};
        }
    }, {
        key: "removeObserverByType",
        value: function removeObserverByType(type) {
            if (this._dictionary.hasKey(type)) {
                delete this._dictionary.type;
            }
        }
    }]);

    return Observer;
}();

exports.default = Observer;

},{}],13:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
	value: true
});
/**This class is automatically generated by LayaAirIDE, please do not make any modifications. */
var CLASS$ = Laya.class;
var STATICATTR$ = Laya.static;
var View = laya.ui.View;
var Dialog = laya.ui.Dialog;
var Scene = Laya.Scene;
if (!window.ui) window.ui = {};
var TestSceneUI = function (_super) {
	function TestSceneUI() {

		TestSceneUI.__super.call(this);
	}
	CLASS$(TestSceneUI, 'ui.test.TestSceneUI', _super);
	var __proto__ = TestSceneUI.prototype;
	__proto__.createChildren = function () {
		_super.prototype.createChildren.call(this);
		this.loadScene("test/TestScene");
	};
	return TestSceneUI;
}(Scene);
exports.default = ui;

},{}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2xheWFFbmdpbmUvcmVzb3VyY2VzL2FwcC9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwic3JjL0dhbWVDb25maWcuanMiLCJzcmMvTWFpbi5qcyIsInNyYy9zY3JpcHQvQ2FtZXJhTWFuYWdlci5qcyIsInNyYy9zY3JpcHQvQ2FtZXJhVHJhbnNTZXQuanMiLCJzcmMvc2NyaXB0L0Zsb29yQmFyTWFuYWdlci5qcyIsInNyYy9zY3JpcHQvRmxvb3JDcmVhdGVNYW5hZ2VyLmpzIiwic3JjL3NjcmlwdC9GbG9vck1vdmVNYW5hZ2VyLmpzIiwic3JjL3NjcmlwdC9HYW1lTWFpblNjZW5lLmpzIiwic3JjL3NjcmlwdC9HYW1lUG9vbC5qcyIsInNyYy9zY3JpcHQvR2FtZVVJLmpzIiwic3JjL3NjcmlwdC9NYW5NYW5hZ2VyLmpzIiwic3JjL3NjcmlwdC9PYnNlcnZlci5qcyIsInNyYy91aS9sYXlhTWF4VUkuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztxakJDVkE7OztBQUNBOzs7Ozs7OztJQUVxQixVOzs7Ozs7OytCQUNIO0FBQ1Y7QUFDQSxnQkFBSSxNQUFNLEtBQUssVUFBTCxDQUFnQixRQUExQjtBQUNOLGdCQUFJLGtCQUFKLEVBQXVCLGdCQUF2QjtBQUNHOzs7Ozs7a0JBTGdCLFU7O0FBT3JCLFdBQVcsS0FBWCxHQUFtQixHQUFuQjtBQUNBLFdBQVcsTUFBWCxHQUFvQixJQUFwQjtBQUNBLFdBQVcsU0FBWCxHQUFzQixZQUF0QjtBQUNBLFdBQVcsVUFBWCxHQUF3QixNQUF4QjtBQUNBLFdBQVcsTUFBWCxHQUFvQixLQUFwQjtBQUNBLFdBQVcsTUFBWCxHQUFvQixNQUFwQjtBQUNBLFdBQVcsVUFBWCxHQUF3QixzQkFBeEI7QUFDQSxXQUFXLFNBQVgsR0FBdUIsRUFBdkI7QUFDQSxXQUFXLEtBQVgsR0FBbUIs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LFNBQVAsQ0FBaUIsY0FBakIsQ0FBZ0MsSUFBaEMsQ0FBcUMsSUFBckM7QUFDQSxPQUFLLFNBQUwsQ0FBZSxnQkFBZjtBQUNBLEVBSEQ7QUFJQSxRQUFPLFdBQVA7QUFDQSxDQVpjLENBWVosS0FaWSxDQUFoQjtRQWFjLE8sR0FBTixFIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG4gICAgfTtcclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8qKlRoaXMgY2xhc3MgaXMgYXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYnkgTGF5YUFpcklERSwgcGxlYXNlIGRvIG5vdCBtYWtlIGFueSBtb2RpZmljYXRpb25zLiAqL1xyXG5pbXBvcnQgR2FtZVVJIGZyb20gXCIuL3NjcmlwdC9HYW1lVUlcIlxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZUNvbmZpZyB7XHJcbiAgICBzdGF0aWMgaW5pdCgpIHtcclxuICAgICAgICAvL+azqOWGjFNjcmlwdOaIluiAhVJ1bnRpbWXlvJXnlKhcclxuICAgICAgICBsZXQgcmVnID0gTGF5YS5DbGFzc1V0aWxzLnJlZ0NsYXNzO1xyXG5cdFx0cmVnKFwic2NyaXB0L0dhbWVVSS5qc1wiLEdhbWVVSSk7XHJcbiAgICB9XHJcbn1cclxuR2FtZUNvbmZpZy53aWR0aCA9IDY0MDtcclxuR2FtZUNvbmZpZy5oZWlnaHQgPSAxMTM2O1xyXG5HYW1lQ29uZmlnLnNjYWxlTW9kZSA9XCJmaXhlZHdpZHRoXCI7XHJcbkdhbWVDb25maWcuc2NyZWVuTW9kZSA9IFwibm9uZVwiO1xyXG5HYW1lQ29uZmlnLmFsaWduViA9IFwidG9wXCI7XHJcbkdhbWVDb25maWcuYWxpZ25IID0gXCJsZWZ0XCI7XHJcbkdhbWVDb25maWcuc3RhcnRTY2VuZSA9IFwidGVzdC9UZXN0U2NlbmUuc2NlbmVcIjtcclxuR2FtZUNvbmZpZy5zY2VuZVJvb3QgPSBcIlwiO1xyXG5HYW1lQ29uZmlnLmRlYnVnID0gZmFsc2U7XHJcbkdhbWVDb25maWcuc3RhdCA9IGZhbHNlO1xyXG5HYW1lQ29uZmlnLnBoeXNpY3NEZWJ1ZyA9IGZhbHNlO1xyXG5HYW1lQ29uZmlnLmV4cG9ydFNjZW5lVG9Kc29uID0gdHJ1ZTtcclxuXHJcbkdhbWVDb25maWcuaW5pdCgpO1xyXG4iLCLvu79pbXBvcnQgR2FtZUNvbmZpZyBmcm9tIFwiLi9HYW1lQ29uZmlnXCI7XHJcbmltcG9ydCB1aSBmcm9tIFwiLi91aS9sYXlhTWF4VUlcIjtcclxuY2xhc3MgTWFpbiB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHQvL+agueaNrklEReiuvue9ruWIneWni+WMluW8leaTjlx0XHRcclxuXHRcdGlmICh3aW5kb3dbXCJMYXlhM0RcIl0pIExheWEzRC5pbml0KEdhbWVDb25maWcud2lkdGgsIEdhbWVDb25maWcuaGVpZ2h0KTtcclxuXHRcdGVsc2UgTGF5YS5pbml0KEdhbWVDb25maWcud2lkdGgsIEdhbWVDb25maWcuaGVpZ2h0LCBMYXlhW1wiV2ViR0xcIl0pO1xyXG5cdFx0TGF5YVtcIlBoeXNpY3NcIl0gJiYgTGF5YVtcIlBoeXNpY3NcIl0uZW5hYmxlKCk7XHJcblx0XHRMYXlhW1wiRGVidWdQYW5lbFwiXSAmJiBMYXlhW1wiRGVidWdQYW5lbFwiXS5lbmFibGUoKTtcclxuXHRcdExheWEuc3RhZ2Uuc2NhbGVNb2RlID0gR2FtZUNvbmZpZy5zY2FsZU1vZGU7XHJcblx0XHRMYXlhLnN0YWdlLnNjcmVlbk1vZGUgPSBHYW1lQ29uZmlnLnNjcmVlbk1vZGU7XHJcblx0XHRMYXlhLnN0YWdlLmFsaWduViA9IEdhbWVDb25maWcuYWxpZ25WO1xyXG5cdFx0TGF5YS5zdGFnZS5hbGlnbkggPSBHYW1lQ29uZmlnLmFsaWduSDtcclxuXHRcdC8v5YW85a655b6u5L+h5LiN5pSv5oyB5Yqg6L29c2NlbmXlkI7nvIDlnLrmma9cclxuXHRcdExheWEuVVJMLmV4cG9ydFNjZW5lVG9Kc29uID0gR2FtZUNvbmZpZy5leHBvcnRTY2VuZVRvSnNvbjtcclxuXHJcblx0XHQvL+aJk+W8gOiwg+ivlemdouadv++8iOmAmui/h0lEReiuvue9ruiwg+ivleaooeW8j++8jOaIluiAhXVybOWcsOWdgOWinuWKoGRlYnVnPXRydWXlj4LmlbDvvIzlnYflj6/miZPlvIDosIPor5XpnaLmnb/vvIlcclxuXHRcdGlmIChHYW1lQ29uZmlnLmRlYnVnIHx8IExheWEuVXRpbHMuZ2V0UXVlcnlTdHJpbmcoXCJkZWJ1Z1wiKSA9PSBcInRydWVcIikgTGF5YS5lbmFibGVEZWJ1Z1BhbmVsKCk7XHJcblx0XHRpZiAoR2FtZUNvbmZpZy5waHlzaWNzRGVidWcgJiYgTGF5YVtcIlBoeXNpY3NEZWJ1Z0RyYXdcIl0pIExheWFbXCJQaHlzaWNzRGVidWdEcmF3XCJdLmVuYWJsZSgpO1xyXG5cdFx0aWYgKEdhbWVDb25maWcuc3RhdCkgTGF5YS5TdGF0LnNob3coKTtcclxuXHRcdExheWEuYWxlcnRHbG9iYWxFcnJvciA9IHRydWU7XHJcblxyXG5cdFx0Ly/mv4DmtLvotYTmupDniYjmnKzmjqfliLbvvIx2ZXJzaW9uLmpzb27nlLFJREXlj5HluIPlip/og73oh6rliqjnlJ/miJDvvIzlpoLmnpzmsqHmnInkuZ/kuI3lvbHlk43lkI7nu63mtYHnqItcclxuXHRcdExheWEuUmVzb3VyY2VWZXJzaW9uLmVuYWJsZShcInZlcnNpb24uanNvblwiLCBMYXlhLkhhbmRsZXIuY3JlYXRlKHRoaXMsIHRoaXMub25WZXJzaW9uTG9hZGVkKSwgTGF5YS5SZXNvdXJjZVZlcnNpb24uRklMRU5BTUVfVkVSU0lPTik7XHJcblx0fVxyXG5cclxuXHRvblZlcnNpb25Mb2FkZWQoKSB7XHJcblx0XHQvL+a/gOa0u+Wkp+Wwj+WbvuaYoOWwhO+8jOWKoOi9veWwj+WbvueahOaXtuWAme+8jOWmguaenOWPkeeOsOWwj+WbvuWcqOWkp+WbvuWQiOmbhumHjOmdou+8jOWImeS8mOWFiOWKoOi9veWkp+WbvuWQiOmbhu+8jOiAjOS4jeaYr+Wwj+WbvlxyXG5cdFx0TGF5YS5BdGxhc0luZm9NYW5hZ2VyLmVuYWJsZShcImZpbGVjb25maWcuanNvblwiLCBMYXlhLkhhbmRsZXIuY3JlYXRlKHRoaXMsIHRoaXMub25Db25maWdMb2FkZWQpKTtcclxuXHR9XHJcblxyXG5cdG9uQ29uZmlnTG9hZGVkKCkge1xyXG5cdFx0Ly/liqDovb1JREXmjIflrprnmoTlnLrmma9cclxuXHRcdEdhbWVDb25maWcuc3RhcnRTY2VuZSAmJiBMYXlhLlNjZW5lLm9wZW4oR2FtZUNvbmZpZy5zdGFydFNjZW5lKTtcclxuXHR9XHJcbn1cclxuLy/mv4DmtLvlkK/liqjnsbtcclxubmV3IE1haW4oKTtcclxuIiwiaW1wb3J0IEdhbWVNYWluU2NlbmUgZnJvbSBcIi4vR2FtZU1haW5TY2VuZVwiO1xuaW1wb3J0IE9ic2VydmVyIGZyb20gXCIuL09ic2VydmVyXCI7XG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FtZXJhTWFuYWdlciBleHRlbmRzIExheWEuU2NyaXB0M0Qge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLl90ZW1wVmVjdG9yMyA9IG5ldyBMYXlhLlZlY3RvcjMoKTtcbiAgICAgICAgdGhpcy55YXdQaXRjaFJvbGwgPSBuZXcgTGF5YS5WZWN0b3IzKCk7XG4gICAgICAgIHRoaXMucmVzdWx0Um90YXRpb24gPSBuZXcgTGF5YS5RdWF0ZXJuaW9uKCk7XG4gICAgICAgIHRoaXMudGVtcFJvdGF0aW9uWiA9IG5ldyBMYXlhLlF1YXRlcm5pb24oKTtcbiAgICAgICAgdGhpcy50ZW1wUm90YXRpb25YID0gbmV3IExheWEuUXVhdGVybmlvbigpO1xuICAgICAgICB0aGlzLnRlbXBSb3RhdGlvblkgPSBuZXcgTGF5YS5RdWF0ZXJuaW9uKCk7XG4gICAgICAgIHRoaXMucm90YWlvblNwZWVkID0gMC4wMDAwNjtcbiAgICAgICAgdGhpcy5jYW1lcmFEZWJ1ZyA9IHRydWU7XG4gICAgICAgIC8vMC4zNCw0Ljg3LC0wLjYyIHBvc1xuICAgICAgICAvLzAuMDYyLDAuNzE4LDAuNjkzLC0wLjAxNSByb3RcbiAgICAgICAgLy90aGlzLnN0YXJ0UG9zID0gbmV3IExheWEuVmVjdG9yMygwLjM0LDQuODcsLTAuNjIpO1xuICAgICAgICAvL3RoaXMuc3RhcnRSb3RhdGlvbiA9IG5ldyBMYXlhLlZlY3RvcjQoMC4wNjIsMC43MTgsMC42OTMsLTAuMDE1KTtcbiAgICAgICAgLy/op4Llr5/ogIVcbiAgICAgICAgdGhpcy5tYWluU2NlbmVPYnNlciA9IDA7XG4gICAgfVxuICAgIG9uQXdha2UoKSB7XG4gICAgICAgIHRoaXMuY2FtZXJhID0gdGhpcy5vd25lcjtcbiAgICAgICAgdGhpcy5tYWluU2NlbmVPYnNlciA9IHRoaXMuY2FtZXJhLnBhcmVudC5nZXRDb21wb25lbnQoR2FtZU1haW5TY2VuZSkubWFpbk9ic2VydmVyO1xuICAgICAgICBpZiAodGhpcy5jYW1lcmFEZWJ1Zykge1xuICAgICAgICAgICAgTGF5YS5zdGFnZS5vbihMYXlhLkV2ZW50LlJJR0hUX01PVVNFX0RPV04sIHRoaXMsIHRoaXMubW91c2VEb3duKTtcbiAgICAgICAgICAgIExheWEuc3RhZ2Uub24oTGF5YS5FdmVudC5SSUdIVF9NT1VTRV9VUCwgdGhpcywgdGhpcy5tb3VzZVVwKTtcbiAgICAgICAgfVxuICAgICAgICAvL3RoaXMuc2V0UG9zQW5kUm90YXRpb24odHJ1ZSwgdGhpcy5zdGFydFBvcywgdGhpcy5zdGFydFJvdGF0aW9uKTtcbiAgICAgICAgdGhpcy5tYWluU2NlbmVPYnNlci53YXRjaChcImNhbWVyYU1vdmVcIiwgdGhpcy5zZXRQb3NBbmRSb3RhdGlvbi5iaW5kKHRoaXMpKTtcbiAgICB9XG4gICAgX29uRGVzdHJveSgpIHtcbiAgICAgICAgLy/lhbPpl63nm5HlkKzlh73mlbBcbiAgICAgICAgTGF5YS5zdGFnZS5vZmYoTGF5YS5FdmVudC5SSUdIVF9NT1VTRV9ET1dOLCB0aGlzLCB0aGlzLm1vdXNlRG93bik7XG4gICAgICAgIExheWEuc3RhZ2Uub2ZmKExheWEuRXZlbnQuUklHSFRfTU9VU0VfVVAsIHRoaXMsIHRoaXMubW91c2VVcCk7XG4gICAgfVxuICAgIG9uVXBkYXRlKHN0YXRlKSB7XG4gICAgICAgXG4gICAgICAgIGlmICghdGhpcy5jYW1lcmFEZWJ1ZykgcmV0dXJuO1xuICAgICAgICBMYXlhLktleUJvYXJkTWFuYWdlci5oYXNLZXlEb3duKDM3KSAmJiB0aGlzLnNob3dQb3NBbmRSb3RhdGlvbihudWxsLDAuMDEsbnVsbCk7XG4gICAgICAgIExheWEuS2V5Qm9hcmRNYW5hZ2VyLmhhc0tleURvd24oMzkpICYmIHRoaXMuc2hvd1Bvc0FuZFJvdGF0aW9uKG51bGwsLTAuMDEsbnVsbCk7XG4gICAgICAgIExheWEuS2V5Qm9hcmRNYW5hZ2VyLmhhc0tleURvd24oMzgpICYmdGhpcy51cGRhdGVSb3RhdGUobnVsbCxudWxsLDAuMDEpOy8vRVxuICAgICAgICBMYXlhLktleUJvYXJkTWFuYWdlci5oYXNLZXlEb3duKDQwKSAmJnRoaXMudXBkYXRlUm90YXRlKG51bGwsbnVsbCwtMC4wMSk7Ly9FXG4gICAgICAgIHZhciBlbGFwc2VkVGltZSA9IExheWEudGltZXIuZGVsdGE7XG4gICAgICAgIC8vIGlmICghaXNOYU4odGhpcy5sYXN0TW91c2VYKSAmJiAhaXNOYU4odGhpcy5sYXN0TW91c2VZKSAmJiB0aGlzLmlzTW91c2VEb3duKSB7XG4gICAgICAgIC8vICAgICB2YXIgc2NlbmUgPSB0aGlzLm93bmVyLnNjZW5lO1xuICAgICAgICAvLyAgICAgTGF5YS5LZXlCb2FyZE1hbmFnZXIuaGFzS2V5RG93big4NykgJiYgdGhpcy5tb3ZlRm9yd2FyZCgtMC4wMSAqIGVsYXBzZWRUaW1lKTsvL1dcbiAgICAgICAgLy8gICAgIExheWEuS2V5Qm9hcmRNYW5hZ2VyLmhhc0tleURvd24oODMpICYmIHRoaXMubW92ZUZvcndhcmQoMC4wMSAqIGVsYXBzZWRUaW1lKTsvL1NcbiAgICAgICAgLy8gICAgIExheWEuS2V5Qm9hcmRNYW5hZ2VyLmhhc0tleURvd24oNjUpICYmIHRoaXMubW92ZVJpZ2h0KC0wLjAxICogZWxhcHNlZFRpbWUpOy8vQVxuICAgICAgICAvLyAgICAgTGF5YS5LZXlCb2FyZE1hbmFnZXIuaGFzS2V5RG93big2OCkgJiYgdGhpcy5tb3ZlUmlnaHQoMC4wMSAqIGVsYXBzZWRUaW1lKTsvL0RcbiAgICAgICAgLy8gICAgIExheWEuS2V5Qm9hcmRNYW5hZ2VyLmhhc0tleURvd24oODEpICYmIHRoaXMubW92ZVZlcnRpY2FsKDAuMDEgKiBlbGFwc2VkVGltZSk7Ly9RXG4gICAgICAgIC8vICAgICBMYXlhLktleUJvYXJkTWFuYWdlci5oYXNLZXlEb3duKDY5KSAmJiB0aGlzLm1vdmVWZXJ0aWNhbCgtMC4wMSAqIGVsYXBzZWRUaW1lKTsvL0VcblxuICAgICAgICAvLyAgICAgdmFyIG9mZnNldFggPSBMYXlhLnN0YWdlLm1vdXNlWCAtIHRoaXMubGFzdE1vdXNlWDtcbiAgICAgICAgLy8gICAgIHZhciBvZmZzZXRZID0gTGF5YS5zdGFnZS5tb3VzZVkgLSB0aGlzLmxhc3RNb3VzZVk7XG5cbiAgICAgICAgLy8gICAgIHZhciB5cHJFbGVtID0gdGhpcy55YXdQaXRjaFJvbGw7XG4gICAgICAgIC8vICAgICB5cHJFbGVtLnggLT0gb2Zmc2V0WCAqIHRoaXMucm90YWlvblNwZWVkICogZWxhcHNlZFRpbWU7XG4gICAgICAgIC8vICAgICB5cHJFbGVtLnkgLT0gb2Zmc2V0WSAqIHRoaXMucm90YWlvblNwZWVkICogZWxhcHNlZFRpbWU7XG4gICAgICAgIC8vICAgICAvL3RoaXMudXBkYXRlUm90YXRpb24oKTtcbiAgICAgICAgLy8gICAgLy8gdGhpcy51cGRhdGVSb3RhdGUob2Zmc2V0WCAqIHRoaXMucm90YWlvblNwZWVkICogZWxhcHNlZFRpbWUsb2Zmc2V0WSAqIHRoaXMucm90YWlvblNwZWVkICogZWxhcHNlZFRpbWUpXG4gICAgICAgIC8vIH1cbiAgICAgICAgLy8gdGhpcy5sYXN0TW91c2VYID0gTGF5YS5zdGFnZS5tb3VzZVg7XG4gICAgICAgIC8vIHRoaXMubGFzdE1vdXNlWSA9IExheWEuc3RhZ2UubW91c2VZO1xuXG5cbiAgICB9XG4gICAgbW91c2VEb3duKGUpIHtcbiAgICAgICAgdGhpcy5zaG93UG9zQW5kUm90YXRpb24oKTtcbiAgICAgICAgLy8gaWYgKCF0aGlzLmNhbWVyYURlYnVnKSByZXR1cm47XG4gICAgICAgIC8vIC8v6I635b6X6byg5qCH55qE5peL6L2s5YC8XG4gICAgICAgIC8vIHRoaXMuY2FtZXJhLnRyYW5zZm9ybS5sb2NhbFJvdGF0aW9uLmdldFlhd1BpdGNoUm9sbCh0aGlzLnlhd1BpdGNoUm9sbCk7XG4gICAgICAgIC8vIC8v6I635b6X6byg5qCH55qEeHnlgLxcbiAgICAgICAgLy8gdGhpcy5sYXN0TW91c2VYID0gTGF5YS5zdGFnZS5tb3VzZVg7XG4gICAgICAgIC8vIHRoaXMubGFzdE1vdXNlWSA9IExheWEuc3RhZ2UubW91c2VZO1xuICAgICAgICAvLyAvL+iuvue9rmJvb2zlgLxcbiAgICAgICAgLy8gdGhpcy5pc01vdXNlRG93biA9IHRydWU7XG5cbiAgICB9XG4gICAgbW91c2VVcChlKSB7XG4gICAgICAgIGlmICghdGhpcy5jYW1lcmFEZWJ1ZykgcmV0dXJuO1xuICAgICAgICAvL+iuvue9rmJvb2zlgLxcbiAgICAgICAgdGhpcy5pc01vdXNlRG93biA9IGZhbHNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiDlkJHliY3np7vliqjjgIJcbiAgICAgKi9cbiAgICBtb3ZlRm9yd2FyZChkaXN0YW5jZSkge1xuICAgICAgICB0aGlzLl90ZW1wVmVjdG9yMy54ID0gMDtcbiAgICAgICAgdGhpcy5fdGVtcFZlY3RvcjMueSA9IDA7XG4gICAgICAgIHRoaXMuX3RlbXBWZWN0b3IzLnogPSBkaXN0YW5jZTtcbiAgICAgICAgdGhpcy5jYW1lcmEudHJhbnNmb3JtLnRyYW5zbGF0ZSh0aGlzLl90ZW1wVmVjdG9yMyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIOWQkeWPs+enu+WKqOOAglxuICAgICAqL1xuICAgIG1vdmVSaWdodChkaXN0YW5jZSkge1xuICAgICAgICB0aGlzLl90ZW1wVmVjdG9yMy55ID0gMDtcbiAgICAgICAgdGhpcy5fdGVtcFZlY3RvcjMueiA9IDA7XG4gICAgICAgIHRoaXMuX3RlbXBWZWN0b3IzLnggPSBkaXN0YW5jZTtcbiAgICAgICAgdGhpcy5jYW1lcmEudHJhbnNmb3JtLnRyYW5zbGF0ZSh0aGlzLl90ZW1wVmVjdG9yMyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIOWQkeS4iuenu+WKqOOAglxuICAgICAqL1xuICAgIG1vdmVWZXJ0aWNhbChkaXN0YW5jZSkge1xuICAgICAgICB0aGlzLl90ZW1wVmVjdG9yMy54ID0gdGhpcy5fdGVtcFZlY3RvcjMueiA9IDA7XG4gICAgICAgIHRoaXMuX3RlbXBWZWN0b3IzLnkgPSBkaXN0YW5jZTtcbiAgICAgICAgdGhpcy5jYW1lcmEudHJhbnNmb3JtLnRyYW5zbGF0ZSh0aGlzLl90ZW1wVmVjdG9yMywgZmFsc2UpO1xuICAgIH1cblxuICAgIHVwZGF0ZVJvdGF0aW9uKCkge1xuICAgICAgIC8vIGlmIChNYXRoLmFicyh0aGlzLnlhd1BpdGNoUm9sbC55KSA8IDEuNTApIHtcbiAgICAgICAgICAgIExheWEuUXVhdGVybmlvbi5jcmVhdGVGcm9tWWF3UGl0Y2hSb2xsKHRoaXMueWF3UGl0Y2hSb2xsLngsIHRoaXMueWF3UGl0Y2hSb2xsLnksIHRoaXMueWF3UGl0Y2hSb2xsLnosIHRoaXMudGVtcFJvdGF0aW9uWik7XG4gICAgICAgICAgICB0aGlzLnRlbXBSb3RhdGlvblouY2xvbmVUbyh0aGlzLmNhbWVyYS50cmFuc2Zvcm0ubG9jYWxSb3RhdGlvbik7XG4gICAgICAgICAgICB0aGlzLmNhbWVyYS50cmFuc2Zvcm0ubG9jYWxSb3RhdGlvbiA9IHRoaXMuY2FtZXJhLnRyYW5zZm9ybS5sb2NhbFJvdGF0aW9uO1xuICAgICAgIC8vIH1cbiAgICB9XG4gICAgc2hvd1Bvc0FuZFJvdGF0aW9uKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcImluZm9ybWF0aW9uOlBvc2l0aW9uXCIpO1xuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmNhbWVyYS50cmFuc2Zvcm0ucG9zaXRpb24pO1xuICAgICAgICBjb25zb2xlLmxvZyhcImluZm9ybWF0aW9uOlJvdGF0aW9uXCIpO1xuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmNhbWVyYS50cmFuc2Zvcm0ucm90YXRpb24pO1xuICAgIH1cbiAgICBzZXRQb3NBbmRSb3RhdGlvbihpc0luaXQsIHBvcywgcm90YXRpb24pIHtcbiAgICAgICAgaWYgKHBvcykge1xuICAgICAgICAgICAgdmFyIHBvc0luZm8gPSB7XG4gICAgICAgICAgICAgICAgY3VyUG9zOiB0aGlzLmNhbWVyYS50cmFuc2Zvcm0ucG9zaXRpb24sXG4gICAgICAgICAgICAgICAgY2hhbmdlUG9zOiBwb3NcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc0luaXQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhbWVyYS50cmFuc2Zvcm0ucG9zaXRpb24gPSBwb3NJbmZvLmNoYW5nZVBvcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGxldCBmaW5hbFBvcz1uZXcgTGF5YS5WZWN0b3IzKDAsMCwwKTtcbiAgICAgICAgICAgICAgICBMYXlhLlZlY3RvcjMuYWRkKHBvc0luZm8uY3VyUG9zLHBvc0luZm8uY2hhbmdlUG9zLGZpbmFsUG9zKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNhbWVyYS50cmFuc2Zvcm0ubG9jYWxQb3NpdGlvbiA9ZmluYWxQb3M7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJvdGF0aW9uKSB7XG4gICAgICAgICAgICB2YXIgcm90YXRpb25JbmZvID0ge1xuICAgICAgICAgICAgICAgIGN1clJvdGF0aW9uOiB0aGlzLmNhbWVyYS50cmFuc2Zvcm0ucm90YXRpb24sXG4gICAgICAgICAgICAgICAgY2hhbmdlUm90YXRpb246IHJvdGF0aW9uXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNJbml0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYW1lcmEudHJhbnNmb3JtLnJvdGF0aW9uID0gcm90YXRpb25JbmZvLmNoYW5nZVJvdGF0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbGV0IGZpbmFsUm90YXRpb249bmV3IExheWEuVmVjdG9yNCgwLDAsMCwwKTtcbiAgICAgICAgICAgICAgICBMYXlhLlZlY3RvcjQuYWRkKHJvdGF0aW9uSW5mby5jaGFuZ2VSb3RhdGlvbixyb3RhdGlvbkluZm8uY3VyUm90YXRpb24sZmluYWxSb3RhdGlvbik7XG4gICAgICAgICAgICAgICAgdGhpcy5jYW1lcmEudHJhbnNmb3JtLnJvdGF0aW9uID0gZmluYWxSb3RhdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgfVxuICAgIHVwZGF0ZVJvdGF0ZShrLGIseikge1xuICAgICAgICBpZihrJiZiKXtcbiAgICAgICAgICAgIHRoaXMuY2FtZXJhLnRyYW5zZm9ybS5yb3RhdGUobmV3IExheWEuVmVjdG9yMyhrLCAwLCBiKSlcbiAgICAgICAgfVxuICAgICAgIGlmKHope1xuICAgICAgICB0aGlzLmNhbWVyYS50cmFuc2Zvcm0ucm90YXRlKG5ldyBMYXlhLlZlY3RvcjMoMCwgeiwgMCkpXG4gICAgICAgfVxuICAgIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYW1lcmFUcmFuc1NldCBleHRlbmRzIExheWEuU2NyaXB0M0Qge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgLy8gdGhpcy5zdGFydFBvcyA9IG5ldyBMYXlhLlZlY3RvcjMoMC4zNCwgNC44NywgLTAuNjIpO1xyXG4gICAgICAgLy8gdGhpcy5zdGFydFBvcyA9IG5ldyBMYXlhLlZlY3RvcjMoMCwgLTUuMTUsIC0xLjE5KTtcclxuICAgICAgIC8vIHRoaXMuc3RhcnRSb3RhdGlvbiA9IG5ldyBMYXlhLlZlY3RvcjQoMC4wNjIsIDAuNzE4LCAwLjY5MywgLTAuMDE1KTtcclxuICAgICAgIC8vIHRoaXMucm90YXRldjM9bmV3IExheWEuVmVjdG9yMygzNy41MywwLDApXHJcblxyXG4gICAgfVxyXG4gICAgb25Bd2FrZSgpIHtcclxuICAgICAgICB0aGlzLmNhbWVyYSA9IHRoaXMub3duZXJcclxuICAgICAgICB0aGlzLnNldFBvc0FuZFJvdGF0aW9uKHRydWUsIHRoaXMuc3RhcnRQb3MsdGhpcy5zdGFydFJvdGF0aW9uKTtcclxuICAgIH1cclxuICAgIG9uRW5hYmxlKCkge1xyXG4gICAgfVxyXG5cclxuICAgIG9uRGlzYWJsZSgpIHtcclxuICAgIH1cclxuICAgIHNldFBvc0FuZFJvdGF0aW9uKGlzSW5pdCwgcG9zLCByb3RhdGlvbiwgcm90YXRlKSB7XHJcbiAgICAgICAgaWYgKHBvcykge1xyXG4gICAgICAgICAgICB2YXIgcG9zSW5mbyA9IHtcclxuICAgICAgICAgICAgICAgIGN1clBvczogdGhpcy5jYW1lcmEudHJhbnNmb3JtLnBvc2l0aW9uLFxyXG4gICAgICAgICAgICAgICAgY2hhbmdlUG9zOiBwb3NcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoaXNJbml0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbWVyYS50cmFuc2Zvcm0ucG9zaXRpb24gPSBwb3NJbmZvLmNoYW5nZVBvcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGxldCBmaW5hbFBvcyA9IG5ldyBMYXlhLlZlY3RvcjMoMCwgMCwgMCk7XHJcbiAgICAgICAgICAgICAgICBMYXlhLlZlY3RvcjMuYWRkKHBvc0luZm8uY3VyUG9zLCBwb3NJbmZvLmNoYW5nZVBvcywgZmluYWxQb3MpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYW1lcmEudHJhbnNmb3JtLnBvc2l0aW9uID0gZmluYWxQb3M7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJvdGF0aW9uKSB7XHJcbiAgICAgICAgICAgIHZhciByb3RhdGlvbkluZm8gPSB7XHJcbiAgICAgICAgICAgICAgICBjdXJSb3RhdGlvbjogdGhpcy5jYW1lcmEudHJhbnNmb3JtLnJvdGF0aW9uLFxyXG4gICAgICAgICAgICAgICAgY2hhbmdlUm90YXRpb246IHJvdGF0aW9uXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGlzSW5pdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYW1lcmEudHJhbnNmb3JtLnJvdGF0aW9uID0gcm90YXRpb25JbmZvLmNoYW5nZVJvdGF0aW9uO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGV0IGZpbmFsUm90YXRpb24gPSBuZXcgTGF5YS5WZWN0b3I0KDAsIDAsIDAsIDApO1xyXG4gICAgICAgICAgICAgICAgTGF5YS5WZWN0b3I0LmFkZChyb3RhdGlvbkluZm8uY2hhbmdlUm90YXRpb24sIHJvdGF0aW9uSW5mby5jdXJSb3RhdGlvbiwgZmluYWxSb3RhdGlvbik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbWVyYS50cmFuc2Zvcm0ucm90YXRpb24gPSBmaW5hbFJvdGF0aW9uO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChyb3RhdGUpIHtcclxuICAgICAgICAgICAgdGhpcy5jYW1lcmEudHJhbnNmb3JtLnJvdGF0ZShyb3RhdGUpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG59IiwiaW1wb3J0IEdhbWVNYWluU2NlbmUgZnJvbSBcIi4vR2FtZU1haW5TY2VuZVwiO1xyXG5pbXBvcnQgR2FtZVBvb2wgZnJvbSBcIi4vR2FtZVBvb2xcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZsb29yQmFyTWFuYWdlciBleHRlbmRzIExheWEuU2NyaXB0M0Qge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgLy/orr7lrprpgJ/luqZcclxuICAgICAgICB0aGlzLnJvdGF0aW9uRGF0YSA9IDA7XHJcbiAgICAgICAgdGhpcy5yb3RhdGVWZWMgPSBMYXlhLlZlY3RvcjMuWkVSTztcclxuICAgICAgICB0aGlzLnRpbWVJbnRlcnYgPSAwO1xyXG4gICAgICAgIHRoaXMucm90YXRpb25TcGVlZCA9IDAuNztcclxuICAgICAgICB0aGlzLmZsYWcgPSBmYWxzZTtcclxuICAgICAgICAvL29ic2VyXHJcbiAgICAgICAgdGhpcy5tYWluU2NlbmVPYnNlciA9IDA7XHJcbiAgICAgICAgdGhpcy5pc0Rpc3Bvc2UgPSBmYWxzZTtcclxuICAgICAgICAvL3Bvb2xcclxuICAgICAgICB0aGlzLmZsb29yQmFyUG9vbCA9IDA7XHJcbiAgICAgICAgdGhpcy5mbG9vclJlY3ljbGUgPSAyO1xyXG4gICAgICAgIHRoaXMudHJhbnMgPSB7IHBvczogMCwgcm90OiAwIH1cclxuXHJcbiAgICB9XHJcbiAgICBvbkF3YWtlKCkge1xyXG4gICAgICAgIHRoaXMuZ2FtZU9iaiA9IHRoaXMub3duZXI7XHJcbiAgICB9XHJcbiAgICBvblN0YXJ0KCkge1xyXG4gICAgICAgIHRoaXMubWFpblNjZW5lT2JzZXIud2F0Y2goXCJnYW1lT3ZlclwiLCB0aGlzLmRpc1Bvc2UuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgdGhpcy5tYWluU2NlbmVPYnNlci53YXRjaChcInJlY3ljbGVcIiwgdGhpcy5yZWN5Y2xlT2JqLmJpbmQodGhpcykpO1xyXG4gICAgICAgIHRoaXMudHJhbnMucG9zID0gdGhpcy5nYW1lT2JqLnRyYW5zZm9ybS5wb3NpdGlvbjtcclxuICAgICAgICB0aGlzLnRyYW5zLnJvdCA9IHRoaXMuZ2FtZU9iai50cmFuc2Zvcm0ucm90YXRpb247XHJcbiAgICB9XHJcbiAgICBvbkVuYWJsZSgpIHtcclxuICAgICAgICB0aGlzLnRpbWVJbnRlcnYgPSAwO1xyXG4gICAgfVxyXG4gICAgb25VcGRhdGUoKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIGlmICh0aGlzLmlzRGlzcG9zZSkgcmV0dXJuO1xyXG4gICAgICAgIGlmICh0aGlzLmdhbWVPYmoubmFtZSA9PT0gR2FtZU1haW5TY2VuZS5mbG9vckJhclR5cGUuYWJub3JtYWwgJiYgdGhpcy5yb3RhdGlvbkRhdGEgIT09IDApIHtcclxuICAgICAgICAgICAgdGhpcy50aW1lSW50ZXJ2ICs9IHRoaXMucm90YXRpb25TcGVlZDtcclxuICAgICAgICAgICAgdGhpcy5yb3RhdGVWZWMuc2V0VmFsdWUoMCwgMCwgdGhpcy5yb3RhdGlvblNwZWVkICogKHRoaXMuZmxhZyA/IDEgOiAtMSkpO1xyXG4gICAgICAgICAgICB0aGlzLmdhbWVPYmoudHJhbnNmb3JtLnJvdGF0ZSh0aGlzLnJvdGF0ZVZlYywgdHJ1ZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy50aW1lSW50ZXJ2ID4gdGhpcy5yb3RhdGlvbkRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudGltZUludGVydiA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZsYWcgPSAhdGhpcy5mbGFnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgb25EaXNhYmxlKCkge1xyXG4gICAgICAgIHRoaXMuZ2FtZU9iai50cmFuc2Zvcm0ucG9zaXRpb24gPSB0aGlzLnRyYW5zLnBvcztcclxuICAgICAgICB0aGlzLmdhbWVPYmoudHJhbnNmb3JtLnJvdGF0aW9uID0gdGhpcy50cmFucy5yb3Q7XHJcbiAgICB9XHJcblxyXG4gICAgZGlzUG9zZSgpIHtcclxuICAgICAgICB0aGlzLmlzRGlzcG9zZSA9IHRydWU7XHJcbiAgICB9XHJcbiAgICByZWN5Y2xlT2JqKGN1ckZsb29ySW5kZXgpIHtcclxuICAgICAgICBpZiAoY3VyRmxvb3JJbmRleCAtIHRoaXMuZmxvb3JSZWN5Y2xlID49IDApIHtcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5nYW1lT2JqLnBhcmVudC5wYXJlbnQucGFyZW50LmdldENoaWxkSW5kZXgodGhpcy5nYW1lT2JqLnBhcmVudC5wYXJlbnQpO1xyXG4gICAgICAgICAgICBpZiAoaW5kZXggPT0gY3VyRmxvb3JJbmRleCAtIHRoaXMuZmxvb3JSZWN5Y2xlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0gdGhpcy5nYW1lT2JqLy8ucGFyZW50LnJlbW92ZUNoaWxkKHRoaXMuZ2FtZU9iaik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZsb29yQmFyUG9vbC5wdXRJdGVtKG9iai5uYW1lLCBvYmopO1xyXG4gICAgICAgICAgICAgICAgLy8gb2JqLnBhcmVudCAmJiB0aGlzLmZsb29yQmFyUG9vbC5wdXRJdGVtKEdhbWVNYWluU2NlbmUuZmxvb3JCYXJUeXBlLmJsYW5rLCBvYmoucGFyZW50KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwiaW1wb3J0IEdhbWVNYWluU2NlbmUgZnJvbSBcIi4vR2FtZU1haW5TY2VuZVwiO1xyXG5pbXBvcnQgRmxvb3JCYXJNYW5hZ2VyIGZyb20gXCIuL0Zsb29yQmFyTWFuYWdlclwiO1xyXG5pbXBvcnQgR2FtZVBvb2wgZnJvbSBcIi4vR2FtZVBvb2xcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZsb29yQ3JlYXRlTWFuYWdlciBleHRlbmRzIExheWEuU2NyaXB0M0Qge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICAvL+inguWvn+iAhVxyXG4gICAgICAgIHRoaXMubWFpblNjZW5lT2JzZXIgPSAwO1xyXG4gICAgICAgIC8v5a+56LGh5rGgXHJcbiAgICAgICAgdGhpcy5mbG9vckJhclBvb2wgPSBuZXcgR2FtZVBvb2woKTtcclxuICAgICAgICB0aGlzLmZsb29yQmFyUHJlZmFiID0gMDtcclxuICAgICAgICB0aGlzLmJsYW5rRmxvb3JQcmVmYWIgPSAwO1xyXG4gICAgICAgIC8v5LiA5qyh5oCn55Sf5LqnRmxvb3LlsYLmlbBcclxuICAgICAgICB0aGlzLmNyZWF0TGF5ZXIgPSA0O1xyXG4gICAgICAgIC8v5q+P5bGC5LmL6Ze055qE6Ze06ZqUeeWAvFxyXG4gICAgICAgIHRoaXMuRmxvb3JJbnRlcnYgPSA4O1xyXG4gICAgICAgIHRoaXMuY3VyRmxvb3JMYXllckluZGV4ID0gMDsvL1xyXG4gICAgfVxyXG4gICAgb25Bd2FrZSgpIHtcclxuICAgICAgICB0aGlzLmdhbWVPYmogPSB0aGlzLm93bmVyO1xyXG4gICAgICAgIHRoaXMubWFpblNjZW5lT2JzZXIgPSB0aGlzLmdhbWVPYmoucGFyZW50LmdldENvbXBvbmVudChHYW1lTWFpblNjZW5lKS5tYWluT2JzZXJ2ZXI7XHJcbiAgICAgICAgdGhpcy5tYWluU2NlbmVPYnNlci53YXRjaChcImNyZWF0Rmxvb3JcIiwgdGhpcy5mbG9vckluaXQuYmluZCh0aGlzKSk7XHJcbiAgICB9XHJcbiAgICBvbkVuYWJsZSgpIHtcclxuXHJcbiAgICB9XHJcbiAgICBvblN0YXJ0KCkge1xyXG4gICAgICAgIC8v6ZqQ6JeP6aKE5Yi25L2TXHJcbiAgICAgICAgdGhpcy5mbG9vckJhclByZWZhYi5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmJsYW5rRmxvb3JQcmVmYWIuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5mbG9vckluaXQodGhpcy5jcmVhdExheWVyKTtcclxuICAgIH1cclxuICAgIG9uVXBkYXRlKCkge1xyXG5cclxuICAgIH1cclxuICAgIC8v5Yid5aeL5YyWXHJcbiAgICBmbG9vckluaXQobnVtKSB7XHJcbiAgICAgICAgLy/lvZPliY3lsYLmlbBcclxuICAgICAgICB2YXIgZmxvb3JJbmRleCA9IDA7XHJcbiAgICAgICAgd2hpbGUgKGZsb29ySW5kZXggPCBudW0pIHtcclxuICAgICAgICAgICAgLy/kuIDlsYLnmoTmgLtGbG9vclxyXG4gICAgICAgICAgICB2YXIgc2luZ2xlRmxvb3IgPSBuZXcgTGF5YS5TcHJpdGUzRCgpO1xyXG4gICAgICAgICAgICB2YXIgcmFuZG9tRGF0YSA9IHRoaXMuZ2V0UmFuZG9tRGF0YSgpO1xyXG4gICAgICAgICAgICB2YXIgYmFzZUJsb2NrID0gdGhpcy5jcmVhdGVCYXNlQmxvY2socmFuZG9tRGF0YSk7XHJcbiAgICAgICAgICAgIHZhciBzcEJsb2NrID0gdGhpcy5jcmVhdFNQQmxvY2socmFuZG9tRGF0YSk7XHJcbiAgICAgICAgICAgIHNpbmdsZUZsb29yLmFkZENoaWxkKGJhc2VCbG9jayk7XHJcbiAgICAgICAgICAgIHNpbmdsZUZsb29yLmFkZENoaWxkKHNwQmxvY2spO1xyXG4gICAgICAgICAgICAvLyDkuIDlsYLnmoRibGFua1xyXG4gICAgICAgICAgICB2YXIgYmxhbmtGbG9vckNsb25lID0gTGF5YS5TcHJpdGUzRC5pbnN0YW50aWF0ZSh0aGlzLmJsYW5rRmxvb3JQcmVmYWIsIHNpbmdsZUZsb29yLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIGJsYW5rRmxvb3JDbG9uZS5uYW1lID0gR2FtZU1haW5TY2VuZS5mbG9vckJhclR5cGUuYmxhbms7XHJcbiAgICAgICAgICAgIGJsYW5rRmxvb3JDbG9uZS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgc2luZ2xlRmxvb3IudHJhbnNmb3JtLnRyYW5zbGF0ZShuZXcgTGF5YS5WZWN0b3IzKDAsIC10aGlzLmN1ckZsb29yTGF5ZXJJbmRleCAqIHRoaXMuRmxvb3JJbnRlcnYsIDApLCB0cnVlKVxyXG4gICAgICAgICAgICBmbG9vckluZGV4Kys7XHJcbiAgICAgICAgICAgIHRoaXMuY3VyRmxvb3JMYXllckluZGV4Kys7XHJcbiAgICAgICAgICAgIHRoaXMuZ2FtZU9iai5hZGRDaGlsZChzaW5nbGVGbG9vcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoq6I635Y+W6ZqP5py65pWw5o2uICovXHJcbiAgICBnZXRSYW5kb21EYXRhKCkge1xyXG4gICAgICAgIHZhciBqc29uRGF0YSA9IExheWEubG9hZGVyLmdldFJlcyhcInJlcy9LSFhNLmpzb25cIik7XHJcbiAgICAgICAgdmFyIGpzb25BcnIgPSBPYmplY3Qua2V5cyhqc29uRGF0YSkubWFwKGtleSA9PiBqc29uRGF0YVtrZXldKTtcclxuICAgICAgICB2YXIgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBqc29uQXJyLmxlbmd0aCk7XHJcbiAgICAgICAgcmV0dXJuIGpzb25BcnJbcmFuZG9tSW5kZXhdO1xyXG4gICAgfVxyXG4gICAgY3JlYXRlQmFzZUJsb2NrKHJhbmRvbURhdGEpIHtcclxuICAgICAgICB2YXIgYmFzZUJsb2NrT2JqcyA9IG5ldyBMYXlhLlNwcml0ZTNEKCk7XHJcbiAgICAgICAgaWYgKCFyYW5kb21EYXRhLmJhc2VfYmxvY2sgaW5zdGFuY2VvZiBBcnJheSkgcmV0dXJuO1xyXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgcmFuZG9tRGF0YS5iYXNlX2Jsb2NrLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgIGxldCBvYmogPSByYW5kb21EYXRhLmJhc2VfYmxvY2tbal07XHJcbiAgICAgICAgICAgIGlmIChvYmopIHtcclxuICAgICAgICAgICAgICAgIHZhciBmbG9vckNsb25lO1xyXG4gICAgICAgICAgICAgICAgdmFyIGZsb29yQ2xvbmUgPSB0aGlzLmZsb29yQmFyUG9vbC5nZXRJdGVtKEdhbWVNYWluU2NlbmUuZmxvb3JCYXJUeXBlLm5vcm1hbCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWZsb29yQ2xvbmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBmbG9vckNsb25lID0gTGF5YS5TcHJpdGUzRC5pbnN0YW50aWF0ZSh0aGlzLmZsb29yQmFyUHJlZmFiLCBiYXNlQmxvY2tPYmpzLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBiYXNlQmxvY2tPYmpzLmFkZENoaWxkKGZsb29yQ2xvbmUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZsb29yQ2xvbmUudHJhbnNmb3JtLnBvc2l0aW9uID0gdGhpcy5mbG9vckJhclByZWZhYi50cmFuc2Zvcm0ucG9zaXRpb247XHJcbiAgICAgICAgICAgICAgICAgICAgZmxvb3JDbG9uZS50cmFuc2Zvcm0ucm90YXRpb24gPSB0aGlzLmZsb29yQmFyUHJlZmFiLnRyYW5zZm9ybS5yb3RhdGlvbjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghZmxvb3JDbG9uZS5nZXRDb21wb25lbnQoRmxvb3JCYXJNYW5hZ2VyKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZsb29yQ2xvbmUuYWRkQ29tcG9uZW50KEZsb29yQmFyTWFuYWdlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgZmxvb3JDbG9uZS5nZXRDb21wb25lbnQoRmxvb3JCYXJNYW5hZ2VyKS5tYWluU2NlbmVPYnNlciA9IHRoaXMubWFpblNjZW5lT2JzZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgZmxvb3JDbG9uZS5nZXRDb21wb25lbnQoRmxvb3JCYXJNYW5hZ2VyKS5mbG9vckJhclBvb2wgPSB0aGlzLmZsb29yQmFyUG9vbDtcclxuICAgICAgICAgICAgICAgICAgICBmbG9vckNsb25lLm5hbWUgPSBHYW1lTWFpblNjZW5lLmZsb29yQmFyVHlwZS5ub3JtYWw7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9iaiA9PT0gMikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbG9vckNsb25lLm5hbWUgPSBHYW1lTWFpblNjZW5lLmZsb29yQmFyVHlwZS5zdGlsbE9ic3RhY2xlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2Zsb29yQ2xvbmXmnZDotKjorr7nva5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZmxvb3JDbG9uZS5tZXNoUmVuZGVyZXIubWF0ZXJpYWwuYWxiZWRvQ29sb3IgPSBuZXcgTGF5YS5WZWN0b3I0KDEsIDAsIDAsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8v5L2N572u6LCD5pW0XHJcbiAgICAgICAgICAgICAgICBmbG9vckNsb25lLnRyYW5zZm9ybS5yb3RhdGUobmV3IExheWEuVmVjdG9yMygwLCAwLCAoaiAqIDIyLjUpKSwgdHJ1ZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgLy/lj43ovawvL3RvZG9cclxuICAgICAgICAgICAgICAgIGlmIChyYW5kb21EYXRhLnJldmVyc2FsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZmxvb3JDbG9uZS50cmFuc2Zvcm0ucm90YXRlKG5ldyBMYXlhLlZlY3RvcjMoMCwgMTgwLCAwKSwgdHJ1ZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGZsb29yQ2xvbmUudHJhbnNmb3JtLnRyYW5zbGF0ZShuZXcgTGF5YS5WZWN0b3IzKDIsIDAsIDApKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZsb29yQ2xvbmUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYmFzZUJsb2NrT2JqcztcclxuICAgIH1cclxuICAgIGNyZWF0U1BCbG9jayhyYW5kb21EYXRhKSB7XHJcbiAgICAgICAgdmFyIHNwQmxvY2tPYmpzID0gbmV3IExheWEuU3ByaXRlM0QoKTtcclxuICAgICAgICBpZiAoIXJhbmRvbURhdGEuc3BfYmxvY2tfc2l6ZSBpbnN0YW5jZW9mIEFycmF5KSByZXR1cm47XHJcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCByYW5kb21EYXRhLnNwX2Jsb2NrX3NpemUubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgbGV0IG9iaiA9IHJhbmRvbURhdGEuc3BfYmxvY2tfc2l6ZVtqXTtcclxuICAgICAgICAgICAgaWYgKG9iaikge1xyXG4gICAgICAgICAgICAgICAgbGV0IG51bSA9IDA7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAobnVtIDwgb2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZsb29yQ2xvbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgZmxvb3JDbG9uZSA9IHRoaXMuZmxvb3JCYXJQb29sLmdldEl0ZW0oR2FtZU1haW5TY2VuZS5mbG9vckJhclR5cGUuYWJub3JtYWwpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZmxvb3JDbG9uZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbG9vckNsb25lID0gTGF5YS5TcHJpdGUzRC5pbnN0YW50aWF0ZSh0aGlzLmZsb29yQmFyUHJlZmFiLCBzcEJsb2NrT2JqcywgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3BCbG9ja09ianMuYWRkQ2hpbGQoZmxvb3JDbG9uZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZsb29yQ2xvbmUudHJhbnNmb3JtLnBvc2l0aW9uID0gdGhpcy5mbG9vckJhclByZWZhYi50cmFuc2Zvcm0ucG9zaXRpb247XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZsb29yQ2xvbmUudHJhbnNmb3JtLnJvdGF0aW9uID0gdGhpcy5mbG9vckJhclByZWZhYi50cmFuc2Zvcm0ucm90YXRpb247XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZmxvb3JDbG9uZS5nZXRDb21wb25lbnQoRmxvb3JCYXJNYW5hZ2VyKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL+mAn+W6plxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbG9vckNsb25lLmFkZENvbXBvbmVudChGbG9vckJhck1hbmFnZXIpLnJvdGF0aW9uRGF0YSA9IHJhbmRvbURhdGEuc3BfYmxvY2tfbW92ZV9zcGVlZFtqXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmxvb3JDbG9uZS5nZXRDb21wb25lbnQoRmxvb3JCYXJNYW5hZ2VyKS5tYWluU2NlbmVPYnNlciA9IHRoaXMubWFpblNjZW5lT2JzZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZsb29yQ2xvbmUuZ2V0Q29tcG9uZW50KEZsb29yQmFyTWFuYWdlcikuZmxvb3JCYXJQb29sID0gdGhpcy5mbG9vckJhclBvb2w7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v5re75Yqg5qCH562+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZsb29yQ2xvbmUubmFtZSA9IEdhbWVNYWluU2NlbmUuZmxvb3JCYXJUeXBlLmFibm9ybWFsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2Zsb29yQ2xvbmXmnZDotKjorr7nva5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZmxvb3JDbG9uZS5tZXNoUmVuZGVyZXIubWF0ZXJpYWwuYWxiZWRvQ29sb3IgPSBuZXcgTGF5YS5WZWN0b3I0KDEsIDAsIDAsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbG9vckNsb25lLnRyYW5zZm9ybS5sb2NhbFNjYWxlID0gbmV3IExheWEuVmVjdG9yMygxLjAwNSwgMS4wMDUsIDEuMDA1KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy/otbflp4vkvY3nva5cclxuICAgICAgICAgICAgICAgICAgICBmbG9vckNsb25lLnRyYW5zZm9ybS5yb3RhdGUobmV3IExheWEuVmVjdG9yMygwLCAwLCAobnVtICogMjIuNSkgKyByYW5kb21EYXRhLnNwX2Jsb2NrX3N0YXJ0X3Bvc1tqXSAqIDIyLjUpLCB0cnVlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy/lj43ovawvL3RvZG9cclxuICAgICAgICAgICAgICAgICAgICAvLyBpZiAocmFuZG9tRGF0YS5yZXZlcnNhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICBmbG9vckNsb25lLnRyYW5zZm9ybS5yb3RhdGUobmV3IExheWEuVmVjdG9yMygwLCAwLCAxODApLCB0cnVlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIGZsb29yQ2xvbmUudHJhbnNmb3JtLnRyYW5zbGF0ZShuZXcgTGF5YS5WZWN0b3IzKDIsIDAsIDApKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgICAgICAgICAgZmxvb3JDbG9uZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIG51bSsrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBzcEJsb2NrT2JqcztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59IiwiaW1wb3J0IEdhbWVNYWluU2NlbmUgZnJvbSBcIi4vR2FtZU1haW5TY2VuZVwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGbG9vck1vdmVNYW5hZ2VyIGV4dGVuZHMgTGF5YS5TY3JpcHQzRCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMueWF3UGl0Y2hSb2xsID0gbmV3IExheWEuVmVjdG9yMygpO1xuICAgICAgICB0aGlzLnRlbXBSb3RhdGlvblogPSBuZXcgTGF5YS5RdWF0ZXJuaW9uKCk7XG4gICAgICAgIHRoaXMucm90YWlvblNwZWVkID0gMC4wMDA1O1xuICAgICAgICAvL29ic2VyXG4gICAgICAgIHRoaXMubWFpblNjZW5lT2JzZXIgPSAwO1xuICAgICAgICB0aGlzLmlzRGlzcG9zZSA9IGZhbHNlO1xuICAgIH1cbiAgICBvbkF3YWtlKCkge1xuICAgICAgICBMYXlhLnN0YWdlLm9uKExheWEuRXZlbnQuTU9VU0VfRE9XTiwgdGhpcywgdGhpcy5tb3VzZURvd24pO1xuICAgICAgICBMYXlhLnN0YWdlLm9uKExheWEuRXZlbnQuTU9VU0VfVVAsIHRoaXMsIHRoaXMubW91c2VVcCk7XG4gICAgICAgIHRoaXMuZ2FtZU9iaiA9IHRoaXMub3duZXI7XG4gICAgICAgIHRoaXMubWFpblNjZW5lT2JzZXIgPSB0aGlzLmdhbWVPYmoucGFyZW50LmdldENvbXBvbmVudChHYW1lTWFpblNjZW5lKS5tYWluT2JzZXJ2ZXI7XG4gICAgICAgIHRoaXMubWFpblNjZW5lT2JzZXIud2F0Y2goXCJnYW1lT3ZlclwiLCB0aGlzLmRpc1Bvc2UuYmluZCh0aGlzKSk7XG4gICAgfVxuICAgIF9vbkRlc3Ryb3koKSB7XG4gICAgICAgIC8v5YWz6Zet55uR5ZCs5Ye95pWwXG4gICAgICAgIExheWEuc3RhZ2Uub2ZmKExheWEuRXZlbnQuTU9VU0VfRE9XTiwgdGhpcywgdGhpcy5tb3VzZURvd24pO1xuICAgICAgICBMYXlhLnN0YWdlLm9mZihMYXlhLkV2ZW50Lk1PVVNFX1VQLCB0aGlzLCB0aGlzLm1vdXNlVXApO1xuICAgIH1cbiAgICBvblVwZGF0ZShzdGF0ZSkge1xuICAgICAgICBpZiAodGhpcy5pc0Rpc3Bvc2UpIHJldHVybjtcbiAgICAgICAgdmFyIGVsYXBzZWRUaW1lID0gTGF5YS50aW1lci5kZWx0YTtcbiAgICAgICAgaWYgKCFpc05hTih0aGlzLmxhc3RNb3VzZVgpICYmIHRoaXMuaXNNb3VzZURvd24pIHtcbiAgICAgICAgICAgIHZhciBvZmZzZXRYID0gTGF5YS5zdGFnZS5tb3VzZVggLSB0aGlzLmxhc3RNb3VzZVg7XG4gICAgICAgICAgICB2YXIgeXByRWxlbSA9IHRoaXMueWF3UGl0Y2hSb2xsO1xuICAgICAgICAgICAgeXByRWxlbS54ICs9IG9mZnNldFggKiB0aGlzLnJvdGFpb25TcGVlZCAqIGVsYXBzZWRUaW1lO1xuICAgICAgICAgICAgLy8gdGhpcy51cGRhdGVSb3RhdGlvbigpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVSb3RhdGUob2Zmc2V0WCAqIHRoaXMucm90YWlvblNwZWVkICogZWxhcHNlZFRpbWUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubGFzdE1vdXNlWCA9IExheWEuc3RhZ2UubW91c2VYO1xuICAgIH1cbiAgICBtb3VzZURvd24oZSkge1xuICAgICAgICAvL+iOt+W+l+m8oOagh+eahOaXi+i9rOWAvFxuICAgICAgICB0aGlzLmdhbWVPYmoudHJhbnNmb3JtLmxvY2FsUm90YXRpb24uZ2V0WWF3UGl0Y2hSb2xsKHRoaXMueWF3UGl0Y2hSb2xsKTtcbiAgICAgICAgLy/ojrflvpfpvKDmoIfnmoR45YC8XG4gICAgICAgIHRoaXMubGFzdE1vdXNlWCA9IExheWEuc3RhZ2UubW91c2VYO1xuICAgICAgICAvL+iuvue9rmJvb2zlgLxcbiAgICAgICAgdGhpcy5pc01vdXNlRG93biA9IHRydWU7XG5cbiAgICB9XG4gICAgbW91c2VVcChlKSB7XG4gICAgICAgIC8v6K6+572uYm9vbOWAvFxuICAgICAgICB0aGlzLmlzTW91c2VEb3duID0gZmFsc2U7XG4gICAgfVxuICAgIHVwZGF0ZVJvdGF0aW9uKCkge1xuICAgICAgICBMYXlhLlF1YXRlcm5pb24uY3JlYXRlRnJvbVlhd1BpdGNoUm9sbCh0aGlzLnlhd1BpdGNoUm9sbC54LCB0aGlzLnlhd1BpdGNoUm9sbC55LCB0aGlzLnlhd1BpdGNoUm9sbC56LCB0aGlzLnRlbXBSb3RhdGlvblopO1xuICAgICAgICB0aGlzLnRlbXBSb3RhdGlvblouY2xvbmVUbyh0aGlzLmdhbWVPYmoudHJhbnNmb3JtLmxvY2FsUm90YXRpb24pO1xuICAgICAgICB0aGlzLmdhbWVPYmoudHJhbnNmb3JtLmxvY2FsUm90YXRpb24gPSB0aGlzLmdhbWVPYmoudHJhbnNmb3JtLmxvY2FsUm90YXRpb247XG4gICAgfVxuICAgIHVwZGF0ZVJvdGF0ZShrKSB7XG4gICAgICAgIHRoaXMuZ2FtZU9iai50cmFuc2Zvcm0ucm90YXRlKG5ldyBMYXlhLlZlY3RvcjMoMCwgaywgMCkpXG4gICAgfVxuICAgIGRpc1Bvc2UoKSB7XG4gICAgICAgIExheWEuc3RhZ2Uub2ZmKExheWEuRXZlbnQuTU9VU0VfRE9XTiwgdGhpcywgdGhpcy5tb3VzZURvd24pO1xuICAgICAgICBMYXlhLnN0YWdlLm9mZihMYXlhLkV2ZW50Lk1PVVNFX1VQLCB0aGlzLCB0aGlzLm1vdXNlVXApO1xuICAgICAgICB0aGlzLmlzRGlzcG9zZSA9IHRydWU7XG4gICAgfVxufSIsImltcG9ydCBNYW5NYW5hZ2VyIGZyb20gXCIuL01hbk1hbmFnZXJcIjtcclxuaW1wb3J0IEZsb29yTW92ZU1hbmFnZXIgZnJvbSBcIi4vRmxvb3JNb3ZlTWFuYWdlclwiO1xyXG5pbXBvcnQgRmxvb3JDcmVhdGVNYW5hZ2VyIGZyb20gXCIuL0Zsb29yQ3JlYXRlTWFuYWdlclwiO1xyXG5pbXBvcnQgQ2FtZXJhTWFuYWdlciBmcm9tIFwiLi9DYW1lcmFNYW5hZ2VyXCI7XHJcbmltcG9ydCBPYnNlcnZlciBmcm9tIFwiLi9PYnNlcnZlclwiO1xyXG5pbXBvcnQgQ2FtZXJhVHJhbnNTZXQgZnJvbSBcIi4vQ2FtZXJhVHJhbnNTZXRcIjtcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZU1haW5TY2VuZSBleHRlbmRzIExheWEuU2NyaXB0M0Qge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICAvLyB0aGlzLm1haW5DYW1lcmEgPSAwO1xyXG4gICAgICAgIC8vIHRoaXMubWFpbkxpZ2h0ID0gMDtcclxuICAgICAgICAvLyB0aGlzLm1hbiA9IDA7XHJcbiAgICAgICAgLy8gdGhpcy5mbG9vckJhclByZWZhYiA9IDA7XHJcbiAgICAgICAgLy8gdGhpcy5jcmVhdEZsb29yID0gMDtcclxuICAgICAgICB0aGlzLm1haW5PYnNlcnZlciA9IG5ldyBPYnNlcnZlcigpO1xyXG4gICAgfVxyXG4gICAgb25Bd2FrZSgpIHtcclxuICAgICAgICB0aGlzLnNjZW5lID0gdGhpcy5vd25lcjtcclxuICAgIH1cclxuICAgIG9uU3RhcnQoKSB7XHJcbiAgICAgICAgdmFyIG1haW5DYW1lcmEgPSB0aGlzLnNjZW5lLmdldENoaWxkQnlOYW1lKFwiTWFpbiBDYW1lcmFcIik7XHJcbiAgICAgICAgbWFpbkNhbWVyYS5hZGRDb21wb25lbnQoQ2FtZXJhTWFuYWdlcik7XHJcbiAgICAgICAgbWFpbkNhbWVyYS5hZGRDb21wb25lbnQoQ2FtZXJhVHJhbnNTZXQpO1xyXG4gICAgICAgIHZhciBtYWluTGlnaHQgPSB0aGlzLnNjZW5lLmdldENoaWxkQnlOYW1lKFwiRGlyZWN0aW9uYWwgTGlnaHRcIik7XHJcbiAgICAgICAgLy/lnLDmnb/lnZfpooTliLbkvZNcclxuICAgICAgICB2YXIgZmxvb3JCYXJQcmVmYWIgPSB0aGlzLnNjZW5lLmdldENoaWxkQnlOYW1lKFwiRmxvb3JCYXJcIik7XHJcbiAgICAgICAgLy/nqbrlnLDmnb/pooTliLbkvZNcclxuICAgICAgICB2YXIgYmxhbmtGbG9vclByZWZhYiA9IHRoaXMuc2NlbmUuZ2V0Q2hpbGRCeU5hbWUoXCJCbGFua0Zsb29yXCIpO1xyXG4gICAgICAgIC8v5Zyw5p2/KOWkjeWQiClcclxuICAgICAgICB2YXIgY3JlYXRGbG9vciA9IHRoaXMuc2NlbmUuZ2V0Q2hpbGRCeU5hbWUoXCJGbG9vckNyZWF0XCIpO1xyXG4gICAgICAgIGNyZWF0Rmxvb3IuYWRkQ29tcG9uZW50KEZsb29yQ3JlYXRlTWFuYWdlcikuZmxvb3JCYXJQcmVmYWIgPSBmbG9vckJhclByZWZhYjtcclxuICAgICAgICBjcmVhdEZsb29yLmdldENvbXBvbmVudChGbG9vckNyZWF0ZU1hbmFnZXIpLmJsYW5rRmxvb3JQcmVmYWIgPSBibGFua0Zsb29yUHJlZmFiO1xyXG4gICAgICAvLyBjcmVhdEZsb29yLmFkZENvbXBvbmVudChGbG9vck1vdmVNYW5hZ2VyKTtcclxuICAgICAgICAvL+iOt+WPluWwj+eQg1xyXG4gICAgICAgIHZhciBtYW4gPSB0aGlzLnNjZW5lLmdldENoaWxkQnlOYW1lKFwiTWFuXCIpO1xyXG4gICAgICAgbWFuLmFkZENvbXBvbmVudChNYW5NYW5hZ2VyKS5mbG9vckNvbnRhaW5lciA9IGNyZWF0Rmxvb3I7XHJcbiAgICAgICBtYW4uZ2V0Q29tcG9uZW50KE1hbk1hbmFnZXIpLmNhbWVyYSA9IG1haW5DYW1lcmE7XHJcblxyXG4gICAgfVxyXG59XHJcbkdhbWVNYWluU2NlbmUuZmxvb3JCYXJUeXBlID0ge1xyXG4gICAgbm9ybWFsOiBcIk5PUk1BTFwiLFxyXG4gICAgYWJub3JtYWw6IFwiQUJOT1JNQUxcIixcclxuICAgIGJsYW5rOiBcIkJMQU5LXCIsXHJcbiAgICBzdGlsbE9ic3RhY2xlOiBcIlNUSUxMT0JTVEFDTEVcIlxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEdhbWVQb29sIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuX3Bvb2wgPSB7fTtcclxuICAgIH1cclxuICAgIGdldEl0ZW0oa2V5KSB7XHJcbiAgICAgICAgdmFyIG9iajtcclxuICAgICAgICBpZiAodGhpcy5fcG9vbFtrZXldKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9wb29sW2tleV0ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBvYmo9dGhpcy5fcG9vbFtrZXldLnBvcCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBvYmo7XHJcbiAgICB9XHJcbiAgICBwdXRJdGVtKGtleSwgb2JqKSB7XHJcbiAgICAgICAgb2JqLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLl9wb29sW2tleV0pIHtcclxuICAgICAgICAgICAgdGhpcy5fcG9vbFtrZXldLnB1c2gob2JqKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Bvb2xba2V5XSA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLl9wb29sW2tleV0ucHVzaChvYmopO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIGdldFBvb2wodHlwZSkge1xyXG5cclxuICAgIC8vIH1cclxuICAgIC8vIGNsZWFyUG9vbCh0eXBlKSB7XHJcblxyXG4gICAgLy8gfVxyXG59IiwiaW1wb3J0IEdhbWVNYWluU2NlbmUgZnJvbSBcIi4vR2FtZU1haW5TY2VuZVwiO1xyXG5cclxuLyoqXHJcbiAqIOacrOekuuS+i+mHh+eUqOmdnuiEmuacrOeahOaWueW8j+WunueOsO+8jOiAjOS9v+eUqOe7p+aJv+mhtemdouWfuuexu++8jOWunueOsOmhtemdoumAu+i+keOAguWcqElERemHjOmdouiuvue9ruWcuuaZr+eahFJ1bnRpbWXlsZ7mgKfljbPlj6/lkozlnLrmma/ov5vooYzlhbPogZRcclxuICog55u45q+U6ISa5pys5pa55byP77yM57un5om/5byP6aG16Z2i57G777yM5Y+v5Lul55u05o6l5L2/55So6aG16Z2i5a6a5LmJ55qE5bGe5oCn77yI6YCa6L+HSURF5YaFdmFy5bGe5oCn5a6a5LmJ77yJ77yM5q+U5aaCdGhpcy50aXBMYmxs77yMdGhpcy5zY29yZUxibO+8jOWFt+acieS7o+eggeaPkOekuuaViOaenFxyXG4gKiDlu7rorq7vvJrlpoLmnpzmmK/pobXpnaLnuqfnmoTpgLvovpHvvIzpnIDopoHpopHnuYHorr/pl67pobXpnaLlhoXlpJrkuKrlhYPntKDvvIzkvb/nlKjnu6fmib/lvI/lhpnms5XvvIzlpoLmnpzmmK/ni6znq4vlsI/mqKHlnZfvvIzlip/og73ljZXkuIDvvIzlu7rorq7nlKjohJrmnKzmlrnlvI/lrp7njrDvvIzmr5TlpoLlrZDlvLnohJrmnKzjgIJcclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdhbWVVSSBleHRlbmRzIExheWEuU2NlbmUge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICAvL+WKoOi9veWcuuaZr+aWh+S7tlxyXG4gICAgICAgIHRoaXMubG9hZFNjZW5lKFwidGVzdC9UZXN0U2NlbmUuc2NlbmVcIik7XHJcbiAgICAgICAgdmFyIHJlc291cmNlID0gW1xyXG4gICAgICAgICAgICB7IHVybDogXCJMYXlhU2NlbmVfU2FtcGxlU2NlbmUvQ29udmVudGlvbmFsL1NhbXBsZVNjZW5lLmxzXCIsIHR5cGU6IExheWEzRC5ISUVSQVJDSFksIHByaW9yaXR5OiAxIH0sXHJcbiAgICAgICAgXVxyXG4gICAgICAgIC8v6aKE5Yqg6L29dW5pdHnlnLrmma9cclxuICAgICAgICBMYXlhLmxvYWRlci5jcmVhdGUocmVzb3VyY2UsIExheWEuSGFuZGxlci5jcmVhdGUodGhpcywgdGhpcy5vbkxvYWRGaW5pc2gpKTtcclxuICAgICAgICAvL+mihOWKoOi9vWpzb25cclxuICAgICAgICBMYXlhLmxvYWRlci5sb2FkKFwicmVzL0tIWE0uanNvblwiLCBMYXlhLkhhbmRsZXIuY3JlYXRlKHRoaXMsIHRoaXMub25Mb2FkZWQpLCBudWxsLCBMYXlhLkxvYWRlci5KU09OLCAwKTtcclxuICAgIH1cclxuICAgIG9uTG9hZEZpbmlzaCgpIHtcclxuICAgICAgICB2YXIgZmlnaHRTY2VuZSA9IExheWEuTG9hZGVyLmdldFJlcyhcIkxheWFTY2VuZV9TYW1wbGVTY2VuZS9Db252ZW50aW9uYWwvU2FtcGxlU2NlbmUubHNcIik7XHJcbiAgICAgICAgTGF5YS5zdGFnZS5hZGRDaGlsZEF0KGZpZ2h0U2NlbmUsIDApO1xyXG4gICAgICAgIGZpZ2h0U2NlbmUuYWRkQ29tcG9uZW50KEdhbWVNYWluU2NlbmUpO1xyXG4gICAgfVxyXG5cclxufSIsImltcG9ydCBHYW1lTWFpblNjZW5lIGZyb20gXCIuL0dhbWVNYWluU2NlbmVcIjtcclxuaW1wb3J0IEZsb29yQ3JlYXRlTWFuYWdlciBmcm9tIFwiLi9GbG9vckNyZWF0ZU1hbmFnZXJcIjtcclxuaW1wb3J0IEdhbWVQb29sIGZyb20gXCIuL0dhbWVQb29sXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNYW5NYW5hZ2VyIGV4dGVuZHMgTGF5YS5TY3JpcHQzRCB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIC8v5by56LW36YCf5bqmXHJcbiAgICAgICAgdGhpcy5yZXN0aVNwZWVkID0gbmV3IExheWEuVmVjdG9yMygwLCA4LCAwKTtcclxuICAgICAgICB0aGlzLmltcHVzbGUgPSBuZXcgTGF5YS5WZWN0b3IzKDAsIC0yLCAwKTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIHRoaXMubWFuUmlnYnkgPSAwO1xyXG4gICAgICAgIHRoaXMuZXF1aXBtZW50ID0ge1xyXG4gICAgICAgICAgICBkZWZlbmNlOiAwLFxyXG4gICAgICAgICAgICBzcGVlZGVyOiAwLFxyXG4gICAgICAgIH1cclxuICAgICAgICAvL+WcuuaZr+WuueWZqFxyXG4gICAgICAgIHRoaXMuZmxvb3JDb250YWluZXIgPSAwO1xyXG4gICAgICAgIC8v6KeC5a+f6ICFXHJcbiAgICAgICAgdGhpcy5tYWluU2NlbmVPYnNlciA9IDA7XHJcbiAgICAgICAgLy/nm7jmnLpcclxuICAgICAgICB0aGlzLmNhbWVyYSA9IDA7XHJcbiAgICAgICAgdGhpcy5jYW1lcmFQb3MgPSB7IHN0YXJ0WTogMCB9O1xyXG4gICAgICAgIHRoaXMuaXNDYW1lcmFNb3ZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5qdXN0TnVtID0gMDtcclxuICAgICAgICB0aGlzLm9mZmVzdE51bSA9IDAuODtcclxuICAgICAgICB0aGlzLnJhdGUgPSAtMC4wNTtcclxuXHJcbiAgICAgICAgLy/lvZPliY3lsYLmlbBcclxuICAgICAgICB0aGlzLmN1ckZsb29yTGF5ZXIgPSAwO1xyXG4gICAgICAgIC8v546p5a625b6X5YiGXHJcbiAgICAgICAgdGhpcy5wbGF5TWFyayA9IDA7XHJcbiAgICAgICAgLy/ljZXmrKHlvpfliIblgLxcclxuICAgICAgICB0aGlzLm1hcmtWYWx1ZVBlciA9IDE7XHJcbiAgICAgICAgLy/njqnlrrblvIDlp4vkvY3nva5cclxuICAgICAgICB0aGlzLm1hblBvcyA9IHsgc3RhcnRZOiAwIH07XHJcbiAgICAgICAgLy/ov57nu63nqb/ov4fnmoRmbG9vclxyXG4gICAgICAgIHRoaXMuY29uc3RhbnRGbG9vckxheWVyID0gMDtcclxuICAgICAgICB0aGlzLmNvbnN0YW50U2V0TGF5ZXIgPSAyO1xyXG5cclxuICAgIH1cclxuICAgIG9uQXdha2UoKSB7XHJcbiAgICAgICAgdGhpcy5nYW1lT2JqID0gdGhpcy5vd25lcjtcclxuICAgICAgICB0aGlzLm1haW5TY2VuZU9ic2VyID0gdGhpcy5nYW1lT2JqLnBhcmVudC5nZXRDb21wb25lbnQoR2FtZU1haW5TY2VuZSkubWFpbk9ic2VydmVyO1xyXG4gICAgfVxyXG4gICAgb25TdGFydCgpIHtcclxuICAgICAgICB0aGlzLm1hblJpZ2J5ID0gdGhpcy5nYW1lT2JqLmdldENvbXBvbmVudChMYXlhLlJpZ2lkYm9keTNEKTtcclxuICAgICAgICB0aGlzLm1hblJpZ2J5Lm1hc3MgPSAxO1xyXG4gICAgICAgIHRoaXMubWFuUmlnYnkuYW5ndWxhckRhbXBpbmcgPSA1MDtcclxuICAgICAgICB0aGlzLm1hblBvcy5zdGFydFkgPSB0aGlzLmdhbWVPYmoudHJhbnNmb3JtLnBvc2l0aW9uLnk7XHJcbiAgICAgICAgdGhpcy5jYW1lcmFQb3Muc3RhcnRZID0gdGhpcy5jYW1lcmEudHJhbnNmb3JtLnBvc2l0aW9uLnk7XHJcbiAgICAgICAgdGhpcy5zZXRDYW1lcmFOdW0odGhpcy5vZmZlc3ROdW0sIHRoaXMucmF0ZSk7XHJcblxyXG5cclxuICAgIH1cclxuICAgIG9uVXBkYXRlKCkge1xyXG4gICAgICAgIC8vY29uc29sZS5sb2codGhpcy5nYW1lT2JqLnRyYW5zZm9ybS5yb3RhdGlvbik7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNDYW1lcmFNb3ZlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FtZXJhLnRyYW5zZm9ybS5sb2NhbFBvc2l0aW9uWSA9IHRoaXMuY2FtZXJhUG9zLnN0YXJ0WSArICh0aGlzLmdhbWVPYmoudHJhbnNmb3JtLnBvc2l0aW9uLnkgLSB0aGlzLm1hblBvcy5zdGFydFkpO1xyXG4gICAgICAgICAgICB0aGlzLmNhbWVyYS50cmFuc2Zvcm0ubG9jYWxQb3NpdGlvblkgLT0gdGhpcy5qdXN0TnVtO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL2lmICghdGhpcy5mbG9vckNvbnRhaW5lci5nZXRDaGlsZEF0KHRoaXMuY3VyRmxvb3JMYXllcikpIHJldHVybjtcclxuICAgICAgICAvL+S4i+mZjeaXtlxyXG4gICAgICAgIC8vIGlmICh0aGlzLmdhbWVPYmoudHJhbnNmb3JtLnBvc2l0aW9uLnk8IHRoaXMuZmxvb3JDb250YWluZXIuZ2V0Q2hpbGRBdCh0aGlzLmN1ckZsb29yTGF5ZXIpLnRyYW5zZm9ybS5wb3NpdGlvbi55KSB7XHJcbiAgICAgICAgLy8gICAgIHRoaXMudG9OZXh0Rmxvb3IoKTtcclxuICAgICAgICAvLyB9XHJcblxyXG5cclxuXHJcblxyXG4gICAgfVxyXG4gICAgb25UcmlnZ2VyRW50ZXIob3RoZXIpIHtcclxuICAgICAgICBzd2l0Y2ggKG90aGVyLm93bmVyLm5hbWUpIHtcclxuICAgICAgICAgICAgY2FzZSBHYW1lTWFpblNjZW5lLmZsb29yQmFyVHlwZS5ibGFuazpcclxuICAgICAgICAgICAgICAgIG90aGVyLm93bmVyLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b05leHRGbG9vcigpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgR2FtZU1haW5TY2VuZS5mbG9vckJhclR5cGUubm9ybWFsOlxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY29uc3RhbnRGbG9vckxheWVyID49IHRoaXMuY29uc3RhbnRTZXRMYXllcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29uc3RhbnRGbG9vckxheWVyID0gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb25zdGFudEVmZmVjdCh0aGlzLmZsb29yQ29udGFpbmVyLmdldENoaWxkQXQodGhpcy5jdXJGbG9vckxheWVyKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnN0YW50Rmxvb3JMYXllciA9IDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmp1bXBVcCgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgR2FtZU1haW5TY2VuZS5mbG9vckJhclR5cGUuc3RpbGxPYnN0YWNsZTpcclxuICAgICAgICAgICAgY2FzZSBHYW1lTWFpblNjZW5lLmZsb29yQmFyVHlwZS5hYm5vcm1hbDpcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnN0YW50Rmxvb3JMYXllciA+PSB0aGlzLmNvbnN0YW50U2V0TGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnN0YW50Rmxvb3JMYXllciA9IC0xO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29uc3RhbnRFZmZlY3QodGhpcy5mbG9vckNvbnRhaW5lci5nZXRDaGlsZEF0KHRoaXMuY3VyRmxvb3JMYXllcikpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuanVtcFVwKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvL3RoaXMuY29uc3RhbnRGbG9vckxheWVyID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3Bvc2UoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgbWFuRm9yY2VTZXQoZm9yY2UsIHBoeSkge1xyXG4gICAgICAgIHRoaXMubWFuUmlnYnkubGluZWFyVmVsb2NpdHkgPSBmb3JjZTtcclxuICAgICAgICB0aGlzLm1hblJpZ2J5LmFuZ3VsYXJWZWxvY2l0eSA9IExheWEuVmVjdG9yMy5aRVJPO1xyXG4gICAgICAgIC8vIHRoaXMuZ2FtZU9iai50cmFuc2Zvcm0ubG9jYWxSb3RhdGlvbiA9IHRoaXMuc3RhclJvdGF0O1xyXG4gICAgICAgIHRoaXMubWFuUmlnYnkuYXBwbHlJbXB1bHNlKHRoaXMuaW1wdXNsZSk7XHJcbiAgICAgICAgLy8gdGhpcy5pbnRlcnYgKz0gTGF5YS50aW1lci5kZWx0YSAqIDAuMDAxO1xyXG4gICAgICAgIC8vIGlmICh0aGlzLmludGVydiA8IHRoaXMucmlzZVRpbWUgLyAyKSB7XHJcbiAgICAgICAgLy8gICAgIHRoaXMuZ2FtZU9iai50cmFuc2Zvcm0ubG9jYWxQb3NpdGlvblkgKz0gdGhpcy5yaXNlRGlzICogTGF5YS50aW1lci5kZWx0YSAqIDAuMDAxIC8gdGhpcy5yaXNlVGltZVxyXG4gICAgICAgIC8vIH1cclxuICAgICAgICAvLyBlbHNlIGlmICh0aGlzLmludGVydiA8IHRoaXMucmlzZVRpbWUpIHRoaXMuZ2FtZU9iai50cmFuc2Zvcm0ubG9jYWxQb3NpdGlvblkgLT0gdGhpcy5yaXNlRGlzICogTGF5YS50aW1lci5kZWx0YSAqIDAuMDAxIC8gdGhpcy5yaXNlVGltZVxyXG4gICAgICAgIC8vIGVsc2Uge1xyXG4gICAgICAgIC8vICAgICB0aGlzLmludGVydiA9IDA7XHJcbiAgICAgICAgLy8gfVxyXG4gICAgfVxyXG4gICAgY29uc3RhbnRFZmZlY3QoY3VyRmxvb3IpIHtcclxuICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgY3VyRmxvb3IuX2NoaWxkcmVuLmxlbmd0aDsgaW5kZXgrKykge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGN1ckZsb29yLmdldENoaWxkQXQoaW5kZXgpLl9jaGlsZHJlbi5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IGN1ckZsb29yLmdldENoaWxkQXQoaW5kZXgpLmdldENoaWxkQXQoaik7XHJcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQudHJhbnNmb3JtLnRyYW5zbGF0ZShuZXcgTGF5YS5WZWN0b3IzKDEsIDEsIDEpKTtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnRyYW5zZm9ybS5yb3RhdGUobmV3IExheWEuVmVjdG9yMygzMCwgNDAsIDUwKSwgZmFsc2UsIGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHRvTmV4dEZsb29yKCkge1xyXG4gICAgICAgIHRoaXMubWFuUmlnYnkuYW5ndWxhclZlbG9jaXR5ID0gTGF5YS5WZWN0b3IzLlpFUk87XHJcbiAgICAgICAgdGhpcy5tYW5Qb3Muc3RhcnRZID0gdGhpcy5nYW1lT2JqLnRyYW5zZm9ybS5wb3NpdGlvbi55Oy8v5Yid5aeL5L2N572uXHJcbiAgICAgICAgdGhpcy5jYW1lcmFQb3Muc3RhcnRZID0gdGhpcy5jYW1lcmEudHJhbnNmb3JtLnBvc2l0aW9uLnk7XHJcbiAgICAgICAgdGhpcy5pc0NhbWVyYU1vdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMubWFpblNjZW5lT2JzZXIubm90aWNlKFwicmVjeWNsZVwiLCB0aGlzLmN1ckZsb29yTGF5ZXIpO1xyXG4gICAgICAgIHRoaXMubWFpblNjZW5lT2JzZXIubm90aWNlKFwiY3JlYXRGbG9vclwiLCAxKTtcclxuICAgICAgICB0aGlzLnBsYXlNYXJrICs9IHRoaXMubWFya1ZhbHVlUGVyO1xyXG4gICAgICAgIExheWEuc3RhZ2UuZ2V0Q2hpbGRBdCgxKS5nZXRDaGlsZEF0KDApLmdldENoaWxkQXQoMCkudGV4dCA9IFwi5YiG5pWwOlwiICsgdGhpcy5wbGF5TWFyaztcclxuICAgICAgICB0aGlzLmNvbnN0YW50Rmxvb3JMYXllcisrO1xyXG4gICAgICAgIHRoaXMuY3VyRmxvb3JMYXllcisrO1xyXG4gICAgICAgIHRoaXMuc2V0Q2FtZXJhTnVtKCk7XHJcbiAgICB9XHJcbiAgICBkZWJ1Z1RyYW5zKG9iaikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKG9iai50cmFuc2Zvcm0ucG9zaXRpb24pO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKG9iai50cmFuc2Zvcm0ubG9jYWxQb3NpdGlvbik7XHJcbiAgICAgICAgY29uc29sZS5sb2cob2JqLnRyYW5zZm9ybS5yb3RhdGlvbik7XHJcbiAgICAgICAgY29uc29sZS5sb2cob2JqLnRyYW5zZm9ybS5sb2NhbFJvdGF0aW9uKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIi0tLS0tLS0tLS0tLS0tLS0tLVwiKTtcclxuXHJcbiAgICB9XHJcbiAgICAvL+iuvue9ruWBj+enu+WAvFxyXG4gICAgc2V0Q2FtZXJhTnVtKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmNvbnN0YW50Rmxvb3JMYXllciAmJiB0aGlzLmNvbnN0YW50Rmxvb3JMYXllciAlIDQgPT0gMCkge1xyXG4gICAgICAgICAgICAvL3RvZG/orr7nva5vZmZlc3TlgY/np7tcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5qdXN0TnVtID0gdGhpcy5vZmZlc3ROdW0gKyB0aGlzLmNvbnN0YW50Rmxvb3JMYXllciAqIHRoaXMucmF0ZTtcclxuICAgIH1cclxuICAgIGRpc3Bvc2UoKSB7XHJcbiAgICAgICAgdGhpcy5tYW5SaWdieS5pc0tpbmVtYXRpYyA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNDYW1lcmFNb3ZlKSB0aGlzLmlzQ2FtZXJhTW92ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubWFpblNjZW5lT2JzZXIubm90aWNlKFwiZ2FtZU92ZXJcIik7XHJcbiAgICAgICAgTGF5YS50aW1lci5vbmNlKDIwMDAsIHRoaXMsICgpID0+IHtcclxuICAgICAgICAgICAgdmFyIGdhbWVPdmVyID0gTGF5YS5zdGFnZS5nZXRDaGlsZEF0KDEpLmdldENoaWxkQXQoMCkuZ2V0Q2hpbGRBdCgxKTtcclxuICAgICAgICAgICAgZ2FtZU92ZXIudmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuICAgIGp1bXBVcChuYW1lKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNDYW1lcmFNb3ZlKSB0aGlzLmlzQ2FtZXJhTW92ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubWFuRm9yY2VTZXQodGhpcy5yZXN0aVNwZWVkKTsvL+WPjeW8uVxyXG4gICAgICAgIHRoaXMuc2V0Q2FtZXJhTnVtKCk7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBPYnNlcnZlciB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5fZGljdGlvbmFyeSA9IHt9O1xyXG4gICAgfVxyXG4gICAgd2F0Y2goa2V5LCBmdW5jKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2RpY3Rpb25hcnlba2V5XSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fZGljdGlvbmFyeVtrZXldICE9IGZ1bmMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2RpY3Rpb25hcnlba2V5XS5wdXNoKGZ1bmMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9kaWN0aW9uYXJ5W2tleV0gPSBbXTtcclxuICAgICAgICAgICAgdGhpcy5fZGljdGlvbmFyeVtrZXldLnB1c2goZnVuYyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgbm90aWNlKGtleSwgLi4uYXJncykge1xyXG4gICAgICAgIGZvciAobGV0IG9iaiBpbiB0aGlzLl9kaWN0aW9uYXJ5W2tleV0pIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2RpY3Rpb25hcnlba2V5XS5oYXNPd25Qcm9wZXJ0eShvYmopKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZWxlbWVudCA9IHRoaXMuX2RpY3Rpb25hcnlba2V5XVtvYmpdXHJcbiAgICAgICAgICAgICAgICBlbGVtZW50KC4uLmFyZ3MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmVtb3ZlQWxsT2JzZXJ2ZXIoKSB7XHJcbiAgICAgICAgdGhpcy5fZGljdGlvbmFyeSA9IHt9O1xyXG4gICAgfVxyXG4gICAgcmVtb3ZlT2JzZXJ2ZXJCeVR5cGUodHlwZSkge1xyXG4gICAgICAgIGlmICh0aGlzLl9kaWN0aW9uYXJ5Lmhhc0tleSh0eXBlKSkge1xyXG4gICAgICAgICAgICBkZWxldGUgdGhpcy5fZGljdGlvbmFyeS50eXBlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0iLCIvKipUaGlzIGNsYXNzIGlzIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGVkIGJ5IExheWFBaXJJREUsIHBsZWFzZSBkbyBub3QgbWFrZSBhbnkgbW9kaWZpY2F0aW9ucy4gKi9cclxudmFyIENMQVNTJD1MYXlhLmNsYXNzO1xyXG52YXIgU1RBVElDQVRUUiQ9TGF5YS5zdGF0aWM7XG52YXIgVmlldz1sYXlhLnVpLlZpZXc7XHJcbnZhciBEaWFsb2c9bGF5YS51aS5EaWFsb2c7XHJcbnZhciBTY2VuZT1MYXlhLlNjZW5lO1xuaWYoIXdpbmRvdy51aSkgd2luZG93LnVpPXt9O1xudmFyIFRlc3RTY2VuZVVJPShmdW5jdGlvbihfc3VwZXIpe1xyXG5cdFx0ZnVuY3Rpb24gVGVzdFNjZW5lVUkoKXtcclxuXHRcdFx0XHJcblx0XHRcdFRlc3RTY2VuZVVJLl9fc3VwZXIuY2FsbCh0aGlzKTtcclxuXHRcdH1cclxuXHRcdENMQVNTJChUZXN0U2NlbmVVSSwndWkudGVzdC5UZXN0U2NlbmVVSScsX3N1cGVyKTtcclxuXHRcdHZhciBfX3Byb3RvX189VGVzdFNjZW5lVUkucHJvdG90eXBlO1xyXG5cdFx0X19wcm90b19fLmNyZWF0ZUNoaWxkcmVuPWZ1bmN0aW9uKCl7XHJcblx0XHRcdF9zdXBlci5wcm90b3R5cGUuY3JlYXRlQ2hpbGRyZW4uY2FsbCh0aGlzKTtcclxuXHRcdFx0dGhpcy5sb2FkU2NlbmUoXCJ0ZXN0L1Rlc3RTY2VuZVwiKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiBUZXN0U2NlbmVVSTtcclxuXHR9KShTY2VuZSk7XG5leHBvcnQge3VpIGFzIGRlZmF1bHR9OyJdfQ==
